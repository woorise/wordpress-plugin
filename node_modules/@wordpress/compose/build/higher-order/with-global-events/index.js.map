{"version":3,"sources":["@wordpress/compose/src/higher-order/with-global-events/index.js"],"names":["listener","Listener","withGlobalEvents","eventTypesToHandlers","since","alternative","WrappedComponent","Wrapper","arguments","handleEvent","bind","handleRef","handler","eventType","add","remove","event","type","wrappedRef","el","props","forwardedRef","ownProps","Component","ref"],"mappings":";;;;;;;;;AAQA;;;;;;;;;;;;;;;;AALA;;AAMA;;AAKA;;AACA;;;;;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAMA,QAAQ,GAAG,IAAIC,iBAAJ,EAAjB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACe,SAASC,gBAAT,CAA2BC,oBAA3B,EAAkD;AAChE,2BAAY,6BAAZ,EAA2C;AAC1CC,IAAAA,KAAK,EAAE,KADmC;AAE1CC,IAAAA,WAAW,EAAE;AAF6B,GAA3C;AAKA,SAAO,yCAA4B,UAAEC,gBAAF,EAAwB;AAAA,QACpDC,OADoD;AAAA;;AAAA;;AAEzD,yBAAc;AAAA;;AAAA;AACb,mCAAUC,SAAV;AAEA,cAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBC,IAAjB,6CAAnB;AACA,cAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeD,IAAf,6CAAjB;AAJa;AAKb;;AAPwD;AAAA;AAAA,eASzD,6BAAoB;AAAA;;AACnB,+BAASP,oBAAT,EAA+B,UAAES,OAAF,EAAWC,SAAX,EAA0B;AACxDb,YAAAA,QAAQ,CAACc,GAAT,CAAcD,SAAd,EAAyB,MAAzB;AACA,WAFD;AAGA;AAbwD;AAAA;AAAA,eAezD,gCAAuB;AAAA;;AACtB,+BAASV,oBAAT,EAA+B,UAAES,OAAF,EAAWC,SAAX,EAA0B;AACxDb,YAAAA,QAAQ,CAACe,MAAT,CAAiBF,SAAjB,EAA4B,MAA5B;AACA,WAFD;AAGA;AAnBwD;AAAA;AAAA,eAqBzD,qBAAaG,KAAb,EAAqB;AACpB,cAAMJ,OAAO,GAAGT,oBAAoB,CAAEa,KAAK,CAACC,IAAR,CAApC;;AACA,cAAK,OAAO,KAAKC,UAAL,CAAiBN,OAAjB,CAAP,KAAsC,UAA3C,EAAwD;AACvD,iBAAKM,UAAL,CAAiBN,OAAjB,EAA4BI,KAA5B;AACA;AACD;AA1BwD;AAAA;AAAA,eA4BzD,mBAAWG,EAAX,EAAgB;AACf,eAAKD,UAAL,GAAkBC,EAAlB,CADe,CAEf;AACA;AACA;;AACA,cAAK,KAAKC,KAAL,CAAWC,YAAhB,EAA+B;AAC9B,iBAAKD,KAAL,CAAWC,YAAX,CAAyBF,EAAzB;AACA;AACD;AApCwD;AAAA;AAAA,eAsCzD,kBAAS;AACR,iBACC,4BAAC,gBAAD,6BACM,KAAKC,KAAL,CAAWE,QADjB;AAEC,YAAA,GAAG,EAAG,KAAKX;AAFZ,aADD;AAMA;AA7CwD;AAAA;AAAA,MACpCY,kBADoC;;AAgD1D,WAAO,yBAAY,UAAEH,KAAF,EAASI,GAAT,EAAkB;AACpC,aAAO,4BAAC,OAAD;AAAS,QAAA,QAAQ,EAAGJ,KAApB;AAA4B,QAAA,YAAY,EAAGI;AAA3C,QAAP;AACA,KAFM,CAAP;AAGA,GAnDM,EAmDJ,kBAnDI,CAAP;AAoDA","sourcesContent":["/**\n * External dependencies\n */\nimport { forEach } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, forwardRef } from '@wordpress/element';\nimport deprecated from '@wordpress/deprecated';\n\n/**\n * Internal dependencies\n */\nimport createHigherOrderComponent from '../../utils/create-higher-order-component';\nimport Listener from './listener';\n\n/**\n * Listener instance responsible for managing document event handling.\n *\n * @type {Listener}\n */\nconst listener = new Listener();\n\n/**\n * Higher-order component creator which, given an object of DOM event types and\n * values corresponding to a callback function name on the component, will\n * create or update a window event handler to invoke the callback when an event\n * occurs. On behalf of the consuming developer, the higher-order component\n * manages unbinding when the component unmounts, and binding at most a single\n * event handler for the entire application.\n *\n * @deprecated\n *\n * @param {Object<string,string>} eventTypesToHandlers Object with keys of DOM\n *                                                     event type, the value a\n *                                                     name of the function on\n *                                                     the original component's\n *                                                     instance which handles\n *                                                     the event.\n *\n * @return {Function} Higher-order component.\n */\nexport default function withGlobalEvents( eventTypesToHandlers ) {\n\tdeprecated( 'wp.compose.withGlobalEvents', {\n\t\tsince: '5.7',\n\t\talternative: 'useEffect',\n\t} );\n\n\treturn createHigherOrderComponent( ( WrappedComponent ) => {\n\t\tclass Wrapper extends Component {\n\t\t\tconstructor() {\n\t\t\t\tsuper( ...arguments );\n\n\t\t\t\tthis.handleEvent = this.handleEvent.bind( this );\n\t\t\t\tthis.handleRef = this.handleRef.bind( this );\n\t\t\t}\n\n\t\t\tcomponentDidMount() {\n\t\t\t\tforEach( eventTypesToHandlers, ( handler, eventType ) => {\n\t\t\t\t\tlistener.add( eventType, this );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tcomponentWillUnmount() {\n\t\t\t\tforEach( eventTypesToHandlers, ( handler, eventType ) => {\n\t\t\t\t\tlistener.remove( eventType, this );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\thandleEvent( event ) {\n\t\t\t\tconst handler = eventTypesToHandlers[ event.type ];\n\t\t\t\tif ( typeof this.wrappedRef[ handler ] === 'function' ) {\n\t\t\t\t\tthis.wrappedRef[ handler ]( event );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\thandleRef( el ) {\n\t\t\t\tthis.wrappedRef = el;\n\t\t\t\t// Any component using `withGlobalEvents` that is not setting a `ref`\n\t\t\t\t// will cause `this.props.forwardedRef` to be `null`, so we need this\n\t\t\t\t// check.\n\t\t\t\tif ( this.props.forwardedRef ) {\n\t\t\t\t\tthis.props.forwardedRef( el );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trender() {\n\t\t\t\treturn (\n\t\t\t\t\t<WrappedComponent\n\t\t\t\t\t\t{ ...this.props.ownProps }\n\t\t\t\t\t\tref={ this.handleRef }\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn forwardRef( ( props, ref ) => {\n\t\t\treturn <Wrapper ownProps={ props } forwardedRef={ ref } />;\n\t\t} );\n\t}, 'withGlobalEvents' );\n}\n"]}