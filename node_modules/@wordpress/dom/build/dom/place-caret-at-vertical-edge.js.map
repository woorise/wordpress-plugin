{"version":3,"sources":["@wordpress/dom/src/dom/place-caret-at-vertical-edge.js"],"names":["placeCaretAtVerticalEdge","container","isReverse","rect","mayUseScroll","isContentEditable","buffer","height","editableRect","getBoundingClientRect","x","left","y","bottom","top","ownerDocument","defaultView","range","contains","startContainer","scrollIntoView","selection","getSelection","removeAllRanges","addRange","focus"],"mappings":";;;;;;;;;AAGA;;AACA;;AAJA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASA,wBAAT,CACdC,SADc,EAEdC,SAFc,EAGdC,IAHc,EAKb;AAAA,MADDC,YACC,uEADc,IACd;;AACD,MAAK,CAAEH,SAAP,EAAmB;AAClB;AACA;;AAED,MAAK,CAAEE,IAAF,IAAU,CAAEF,SAAS,CAACI,iBAA3B,EAA+C;AAC9C,6CAA4BJ,SAA5B,EAAuCC,SAAvC;AACA;AACA,GARA,CAUD;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAMI,MAAM,GAAGH,IAAI,CAACI,MAAL,GAAc,CAA7B;AACA,MAAMC,YAAY,GAAGP,SAAS,CAACQ,qBAAV,EAArB;AACA,MAAMC,CAAC,GAAGP,IAAI,CAACQ,IAAf;AACA,MAAMC,CAAC,GAAGV,SAAS,GAChBM,YAAY,CAACK,MAAb,GAAsBP,MADN,GAEhBE,YAAY,CAACM,GAAb,GAAmBR,MAFtB;AAnBC,MAuBOS,aAvBP,GAuByBd,SAvBzB,CAuBOc,aAvBP;AAAA,MAwBOC,WAxBP,GAwBuBD,aAxBvB,CAwBOC,WAxBP;AAyBD,MAAMC,KAAK,GAAG,wCAA2BF,aAA3B,EAA0CL,CAA1C,EAA6CE,CAA7C,EAAgDX,SAAhD,CAAd;;AAEA,MAAK,CAAEgB,KAAF,IAAW,CAAEhB,SAAS,CAACiB,QAAV,CAAoBD,KAAK,CAACE,cAA1B,CAAlB,EAA+D;AAC9D,QACCf,YAAY,KACV,CAAEa,KAAF,IACD,CAAEA,KAAK,CAACE,cADP,IAED,CAAEF,KAAK,CAACE,cAAN,CAAqBD,QAArB,CAA+BjB,SAA/B,CAHS,CADb,EAKE;AACD;AACA;AACAA,MAAAA,SAAS,CAACmB,cAAV,CAA0BlB,SAA1B;AACAF,MAAAA,wBAAwB,CAAEC,SAAF,EAAaC,SAAb,EAAwBC,IAAxB,EAA8B,KAA9B,CAAxB;AACA;AACA;;AAED,6CAA4BF,SAA5B,EAAuCC,SAAvC;AACA;AACA;;AAED,MAAMmB,SAAS,GAAGL,WAAW,CAACM,YAAZ,EAAlB;AACAD,EAAAA,SAAS,CAACE,eAAV;AACAF,EAAAA,SAAS,CAACG,QAAV,CAAoBP,KAApB;AACAhB,EAAAA,SAAS,CAACwB,KAAV,GAhDC,CAiDD;AACA;;AACAJ,EAAAA,SAAS,CAACE,eAAV;AACAF,EAAAA,SAAS,CAACG,QAAV,CAAoBP,KAApB;AACA","sourcesContent":["/**\n * Internal dependencies\n */\nimport placeCaretAtHorizontalEdge from './place-caret-at-horizontal-edge';\nimport hiddenCaretRangeFromPoint from './hidden-caret-range-from-point';\n\n/**\n * Places the caret at the top or bottom of a given element.\n *\n * @param {Element} container           Focusable element.\n * @param {boolean} isReverse           True for bottom, false for top.\n * @param {DOMRect} [rect]              The rectangle to position the caret with.\n * @param {boolean} [mayUseScroll=true] True to allow scrolling, false to disallow.\n */\nexport default function placeCaretAtVerticalEdge(\n\tcontainer,\n\tisReverse,\n\trect,\n\tmayUseScroll = true\n) {\n\tif ( ! container ) {\n\t\treturn;\n\t}\n\n\tif ( ! rect || ! container.isContentEditable ) {\n\t\tplaceCaretAtHorizontalEdge( container, isReverse );\n\t\treturn;\n\t}\n\n\t// Offset by a buffer half the height of the caret rect. This is needed\n\t// because caretRangeFromPoint may default to the end of the selection if\n\t// offset is too close to the edge. It's unclear how to precisely calculate\n\t// this threshold; it may be the padded area of some combination of line\n\t// height, caret height, and font size. The buffer offset is effectively\n\t// equivalent to a point at half the height of a line of text.\n\tconst buffer = rect.height / 2;\n\tconst editableRect = container.getBoundingClientRect();\n\tconst x = rect.left;\n\tconst y = isReverse\n\t\t? editableRect.bottom - buffer\n\t\t: editableRect.top + buffer;\n\n\tconst { ownerDocument } = container;\n\tconst { defaultView } = ownerDocument;\n\tconst range = hiddenCaretRangeFromPoint( ownerDocument, x, y, container );\n\n\tif ( ! range || ! container.contains( range.startContainer ) ) {\n\t\tif (\n\t\t\tmayUseScroll &&\n\t\t\t( ! range ||\n\t\t\t\t! range.startContainer ||\n\t\t\t\t! range.startContainer.contains( container ) )\n\t\t) {\n\t\t\t// Might be out of view.\n\t\t\t// Easier than attempting to calculate manually.\n\t\t\tcontainer.scrollIntoView( isReverse );\n\t\t\tplaceCaretAtVerticalEdge( container, isReverse, rect, false );\n\t\t\treturn;\n\t\t}\n\n\t\tplaceCaretAtHorizontalEdge( container, isReverse );\n\t\treturn;\n\t}\n\n\tconst selection = defaultView.getSelection();\n\tselection.removeAllRanges();\n\tselection.addRange( range );\n\tcontainer.focus();\n\t// Editable was already focussed, it goes back to old range...\n\t// This fixes it.\n\tselection.removeAllRanges();\n\tselection.addRange( range );\n}\n"]}