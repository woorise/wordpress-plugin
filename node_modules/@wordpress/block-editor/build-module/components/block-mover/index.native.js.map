{"version":3,"sources":["@wordpress/block-editor/src/components/block-mover/index.native.js"],"names":["first","last","partial","castArray","Platform","__","Picker","ToolbarButton","withInstanceId","compose","withSelect","withDispatch","useRef","useState","getMoversSetup","store","blockEditorStore","BLOCK_MOVER_DIRECTION_TOP","BLOCK_MOVER_DIRECTION_BOTTOM","BlockMover","isFirst","isLast","isLocked","onMoveDown","onMoveUp","onLongMove","firstIndex","numberOfBlocks","rootClientId","isStackedHorizontally","pickerRef","undefined","blockPageMoverState","setBlockPageMoverState","showBlockPageMover","direction","current","presentPicker","description","backwardButtonHint","forwardButtonHint","firstBlockTitle","lastBlockTitle","icon","backwardButtonIcon","backward","forwardButtonIcon","forward","title","backwardButtonTitle","forwardButtonTitle","blockPageMoverOptions","label","value","onSelect","filter","el","onPickerSelect","option","find","hint","OS","select","clientIds","getBlockIndex","getTemplateLock","getBlockRootClientId","getBlockOrder","normalizedClientIds","firstClientId","blockOrder","lastIndex","length","dispatch","moveBlocksDown","moveBlocksUp","moveBlocksToPosition","targetIndex"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { first, last, partial, castArray } from 'lodash';\nimport { Platform } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Picker, ToolbarButton } from '@wordpress/components';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { useRef, useState } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { getMoversSetup } from './mover-description';\nimport { store as blockEditorStore } from '../../store';\n\nexport const BLOCK_MOVER_DIRECTION_TOP = 'blockPageMoverOptions-moveToTop';\nexport const BLOCK_MOVER_DIRECTION_BOTTOM =\n\t'blockPageMoverOptions-moveToBottom';\n\nexport const BlockMover = ( {\n\tisFirst,\n\tisLast,\n\tisLocked,\n\tonMoveDown,\n\tonMoveUp,\n\tonLongMove,\n\tfirstIndex,\n\tnumberOfBlocks,\n\trootClientId,\n\tisStackedHorizontally,\n} ) => {\n\tconst pickerRef = useRef();\n\tconst [ blockPageMoverState, setBlockPageMoverState ] = useState(\n\t\tundefined\n\t);\n\tconst showBlockPageMover = ( direction ) => () => {\n\t\tif ( ! pickerRef.current ) {\n\t\t\tsetBlockPageMoverState( undefined );\n\t\t\treturn;\n\t\t}\n\n\t\tsetBlockPageMoverState( direction );\n\t\tpickerRef.current.presentPicker();\n\t};\n\n\tconst {\n\t\tdescription: {\n\t\t\tbackwardButtonHint,\n\t\t\tforwardButtonHint,\n\t\t\tfirstBlockTitle,\n\t\t\tlastBlockTitle,\n\t\t},\n\t\ticon: { backward: backwardButtonIcon, forward: forwardButtonIcon },\n\t\ttitle: { backward: backwardButtonTitle, forward: forwardButtonTitle },\n\t} = getMoversSetup( isStackedHorizontally, { firstIndex } );\n\n\tconst blockPageMoverOptions = [\n\t\t{\n\t\t\ticon: backwardButtonIcon,\n\t\t\tlabel: __( 'Move to top' ),\n\t\t\tvalue: BLOCK_MOVER_DIRECTION_TOP,\n\t\t\tonSelect: () => {\n\t\t\t\tonLongMove()( 0 );\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ticon: forwardButtonIcon,\n\t\t\tlabel: __( 'Move to bottom' ),\n\t\t\tvalue: BLOCK_MOVER_DIRECTION_BOTTOM,\n\t\t\tonSelect: () => {\n\t\t\t\tonLongMove()( numberOfBlocks );\n\t\t\t},\n\t\t},\n\t].filter( ( el ) => el.value === blockPageMoverState );\n\n\tconst onPickerSelect = ( value ) => {\n\t\tconst option = blockPageMoverOptions.find(\n\t\t\t( el ) => el.value === value\n\t\t);\n\t\tif ( option && option.onSelect ) option.onSelect();\n\t};\n\n\tif ( isLocked || ( isFirst && isLast && ! rootClientId ) ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<ToolbarButton\n\t\t\t\ttitle={ ! isFirst ? backwardButtonTitle : firstBlockTitle }\n\t\t\t\tisDisabled={ isFirst }\n\t\t\t\tonClick={ onMoveUp }\n\t\t\t\tonLongPress={ showBlockPageMover( BLOCK_MOVER_DIRECTION_TOP ) }\n\t\t\t\ticon={ backwardButtonIcon }\n\t\t\t\textraProps={ { hint: backwardButtonHint } }\n\t\t\t/>\n\n\t\t\t<ToolbarButton\n\t\t\t\ttitle={ ! isLast ? forwardButtonTitle : lastBlockTitle }\n\t\t\t\tisDisabled={ isLast }\n\t\t\t\tonClick={ onMoveDown }\n\t\t\t\tonLongPress={ showBlockPageMover(\n\t\t\t\t\tBLOCK_MOVER_DIRECTION_BOTTOM\n\t\t\t\t) }\n\t\t\t\ticon={ forwardButtonIcon }\n\t\t\t\textraProps={ {\n\t\t\t\t\thint: forwardButtonHint,\n\t\t\t\t} }\n\t\t\t/>\n\n\t\t\t<Picker\n\t\t\t\tref={ pickerRef }\n\t\t\t\toptions={ blockPageMoverOptions }\n\t\t\t\tonChange={ onPickerSelect }\n\t\t\t\ttitle={ __( 'Change block position' ) }\n\t\t\t\tleftAlign={ true }\n\t\t\t\thideCancelButton={ Platform.OS !== 'ios' }\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default compose(\n\twithSelect( ( select, { clientIds } ) => {\n\t\tconst {\n\t\t\tgetBlockIndex,\n\t\t\tgetTemplateLock,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockOrder,\n\t\t} = select( blockEditorStore );\n\t\tconst normalizedClientIds = castArray( clientIds );\n\t\tconst firstClientId = first( normalizedClientIds );\n\t\tconst rootClientId = getBlockRootClientId( firstClientId );\n\t\tconst blockOrder = getBlockOrder( rootClientId );\n\t\tconst firstIndex = getBlockIndex( firstClientId, rootClientId );\n\t\tconst lastIndex = getBlockIndex(\n\t\t\tlast( normalizedClientIds ),\n\t\t\trootClientId\n\t\t);\n\n\t\treturn {\n\t\t\tfirstIndex,\n\t\t\tnumberOfBlocks: blockOrder.length - 1,\n\t\t\tisFirst: firstIndex === 0,\n\t\t\tisLast: lastIndex === blockOrder.length - 1,\n\t\t\tisLocked: getTemplateLock( rootClientId ) === 'all',\n\t\t\trootClientId,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientIds, rootClientId } ) => {\n\t\tconst { moveBlocksDown, moveBlocksUp, moveBlocksToPosition } = dispatch(\n\t\t\tblockEditorStore\n\t\t);\n\t\treturn {\n\t\t\tonMoveDown: partial( moveBlocksDown, clientIds, rootClientId ),\n\t\t\tonMoveUp: partial( moveBlocksUp, clientIds, rootClientId ),\n\t\t\tonLongMove: ( targetIndex ) =>\n\t\t\t\tpartial(\n\t\t\t\t\tmoveBlocksToPosition,\n\t\t\t\t\tclientIds,\n\t\t\t\t\trootClientId,\n\t\t\t\t\ttargetIndex\n\t\t\t\t),\n\t\t};\n\t} ),\n\twithInstanceId\n)( BlockMover );\n"]}