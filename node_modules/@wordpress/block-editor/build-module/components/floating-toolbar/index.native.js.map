{"version":3,"sources":["@wordpress/block-editor/src/components/floating-toolbar/index.native.js"],"names":["Animated","Easing","View","Platform","ToolbarButton","Toolbar","useEffect","useState","withSelect","withDispatch","compose","__","styles","NavigateUpSVG","BlockSelectionButton","store","blockEditorStore","EASE_IN_DURATION","EASE_OUT_DURATION","TRANSLATION_RANGE","opacity","Value","FloatingToolbar","selectedClientId","parentId","showFloatingToolbar","onNavigateUp","isRTL","previousSelection","setPreviousSelection","timing","toValue","duration","easing","ease","useNativeDriver","start","clientId","translationRange","OS","translation","interpolate","inputRange","outputRange","animationStyle","transform","translateY","previousSelectedClientId","previousSelectedParentId","showPrevious","blockSelectionButtonClientId","showNavUpButton","floatingToolbar","toolbar","pipe","select","getSelectedBlockClientId","getBlockHierarchyRootClientId","getBlockRootClientId","getBlockCount","getSettings","rootBlockId","dispatch","selectBlock","initialPosition"],"mappings":";;;AAAA;AACA;AACA;AACA,SAASA,QAAT,EAAmBC,MAAnB,EAA2BC,IAA3B,EAAiCC,QAAjC,QAAiD,cAAjD;AAEA;AACA;AACA;;AACA,SAASC,aAAT,EAAwBC,OAAxB,QAAuC,uBAAvC;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,oBAApC;AACA,SAASC,UAAT,EAAqBC,YAArB,QAAyC,iBAAzC;AACA,SAASC,OAAT,QAAwB,oBAAxB;AACA,SAASC,EAAT,QAAmB,iBAAnB;AAEA;AACA;AACA;;AACA,OAAOC,MAAP,MAAmB,eAAnB;AACA,OAAOC,aAAP,MAA0B,eAA1B;AACA,OAAOC,oBAAP,MAAiC,6CAAjC;AACA,SAASC,KAAK,IAAIC,gBAAlB,QAA0C,aAA1C;AAEA,IAAMC,gBAAgB,GAAG,GAAzB;AACA,IAAMC,iBAAiB,GAAG,EAA1B;AACA,IAAMC,iBAAiB,GAAG,CAA1B;AAEA,IAAMC,OAAO,GAAG,IAAIpB,QAAQ,CAACqB,KAAb,CAAoB,CAApB,CAAhB;;AAEA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,OAMjB;AAAA,MALNC,gBAKM,QALNA,gBAKM;AAAA,MAJNC,QAIM,QAJNA,QAIM;AAAA,MAHNC,mBAGM,QAHNA,mBAGM;AAAA,MAFNC,YAEM,QAFNA,YAEM;AAAA,MADNC,KACM,QADNA,KACM;;AACN;AADM,kBAE8CpB,QAAQ,CAAE,EAAF,CAFtD;AAAA;AAAA,MAEEqB,iBAFF;AAAA,MAEqBC,oBAFrB;;AAINvB,EAAAA,SAAS,CAAE,YAAM;AAChBN,IAAAA,QAAQ,CAAC8B,MAAT,CAAiBV,OAAjB,EAA0B;AACzBW,MAAAA,OAAO,EAAEN,mBAAmB,GAAG,CAAH,GAAO,CADV;AAEzBO,MAAAA,QAAQ,EAAEP,mBAAmB,GAC1BR,gBAD0B,GAE1BC,iBAJsB;AAKzBe,MAAAA,MAAM,EAAEhC,MAAM,CAACiC,IALU;AAMzBC,MAAAA,eAAe,EAAE;AANQ,KAA1B,EAOIC,KAPJ;AAQA,GATQ,EASN,CAAEX,mBAAF,CATM,CAAT;AAWAnB,EAAAA,SAAS,CAAE,YAAM;AAChB,QAAKmB,mBAAL,EACCI,oBAAoB,CAAE;AAAEQ,MAAAA,QAAQ,EAAEd,gBAAZ;AAA8BC,MAAAA,QAAQ,EAARA;AAA9B,KAAF,CAApB;AACD,GAHQ,EAGN,CAAED,gBAAF,CAHM,CAAT;AAKA,MAAMe,gBAAgB,GACrB,CAAEnC,QAAQ,CAACoC,EAAT,KAAgB,SAAhB,GAA4B,CAAC,CAA7B,GAAiC,CAAnC,IAAyCpB,iBAD1C;AAGA,MAAMqB,WAAW,GAAGpB,OAAO,CAACqB,WAAR,CAAqB;AACxCC,IAAAA,UAAU,EAAE,CAAE,CAAF,EAAK,CAAL,CAD4B;AAExCC,IAAAA,WAAW,EAAE,CAAEL,gBAAF,EAAoB,CAApB;AAF2B,GAArB,CAApB;AAKA,MAAMM,cAAc,GAAG;AACtBxB,IAAAA,OAAO,EAAPA,OADsB;AAEtByB,IAAAA,SAAS,EAAE,CAAE;AAAEC,MAAAA,UAAU,EAAEN;AAAd,KAAF;AAFW,GAAvB;AA5BM,MAkCKO,wBAlCL,GAoCFnB,iBApCE,CAkCLS,QAlCK;AAAA,MAmCKW,wBAnCL,GAoCFpB,iBApCE,CAmCLJ,QAnCK;AAsCN,MAAMyB,YAAY,GAAGF,wBAAwB,IAAI,CAAEtB,mBAAnD;AACA,MAAMyB,4BAA4B,GAAGD,YAAY,GAC9CF,wBAD8C,GAE9CxB,gBAFH;AAGA,MAAM4B,eAAe,GACpB,CAAC,CAAE3B,QAAH,IAAiByB,YAAY,IAAI,CAAC,CAAED,wBADrC;AAGA,SACC,CAAC,CAAE5B,OAAH,IACC,cAAC,QAAD,CAAU,IAAV;AAAe,IAAA,KAAK,EAAG,CAAER,MAAM,CAACwC,eAAT,EAA0BR,cAA1B;AAAvB,KACGO,eAAe,IAChB,cAAC,OAAD;AAAS,IAAA,WAAW,EAAGvC,MAAM,CAACyC;AAA9B,KACC,cAAC,aAAD;AACC,IAAA,KAAK,EAAG1C,EAAE,CAAE,aAAF,CADX;AAEC,IAAA,OAAO,EACN,CAAEsC,YAAF,IACE;AAAA,aAAMvB,YAAY,CAAEF,QAAF,CAAlB;AAAA,KAJJ;AAMC,IAAA,IAAI,EAAG,cAAC,aAAD;AAAe,MAAA,KAAK,EAAGG;AAAvB;AANR,IADD,EASC,cAAC,IAAD;AAAM,IAAA,KAAK,EAAGf,MAAM,CAAC0C;AAArB,IATD,CAFF,EAcC,cAAC,oBAAD;AACC,IAAA,QAAQ,EAAGJ;AADZ,IAdD,CAFF;AAsBA,CAzED;;AA2EA,eAAexC,OAAO,CAAE,CACvBF,UAAU,CAAE,UAAE+C,MAAF,EAAc;AAAA,gBAOrBA,MAAM,CAAEvC,gBAAF,CAPe;AAAA,MAExBwC,wBAFwB,WAExBA,wBAFwB;AAAA,MAGxBC,6BAHwB,WAGxBA,6BAHwB;AAAA,MAIxBC,oBAJwB,WAIxBA,oBAJwB;AAAA,MAKxBC,aALwB,WAKxBA,aALwB;AAAA,MAMxBC,WANwB,WAMxBA,WANwB;;AASzB,MAAMrC,gBAAgB,GAAGiC,wBAAwB,EAAjD;AAEA,MAAK,CAAEjC,gBAAP,EAA0B;AAE1B,MAAMsC,WAAW,GAAGJ,6BAA6B,CAAElC,gBAAF,CAAjD;AAEA,SAAO;AACNA,IAAAA,gBAAgB,EAAhBA,gBADM;AAENE,IAAAA,mBAAmB,EAAE,CAAC,CAAEkC,aAAa,CAAEE,WAAF,CAF/B;AAGNrC,IAAAA,QAAQ,EAAEkC,oBAAoB,CAAEnC,gBAAF,CAHxB;AAINI,IAAAA,KAAK,EAAEiC,WAAW,GAAGjC;AAJf,GAAP;AAMA,CArBS,CADa,EAuBvBlB,YAAY,CAAE,UAAEqD,QAAF,EAAgB;AAAA,kBACLA,QAAQ,CAAE9C,gBAAF,CADH;AAAA,MACrB+C,WADqB,aACrBA,WADqB;;AAG7B,SAAO;AACNrC,IAAAA,YADM,wBACQW,QADR,EACkB2B,eADlB,EACoC;AACzCD,MAAAA,WAAW,CAAE1B,QAAF,EAAY2B,eAAZ,CAAX;AACA;AAHK,GAAP;AAKA,CARW,CAvBW,CAAF,CAAP,CAgCV1C,eAhCU,CAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { Animated, Easing, View, Platform } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { ToolbarButton, Toolbar } from '@wordpress/components';\nimport { useEffect, useState } from '@wordpress/element';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport NavigateUpSVG from './nav-up-icon';\nimport BlockSelectionButton from '../block-list/block-selection-button.native';\nimport { store as blockEditorStore } from '../../store';\n\nconst EASE_IN_DURATION = 250;\nconst EASE_OUT_DURATION = 80;\nconst TRANSLATION_RANGE = 8;\n\nconst opacity = new Animated.Value( 0 );\n\nconst FloatingToolbar = ( {\n\tselectedClientId,\n\tparentId,\n\tshowFloatingToolbar,\n\tonNavigateUp,\n\tisRTL,\n} ) => {\n\t// Sustain old selection for proper block selection button rendering when exit animation is ongoing.\n\tconst [ previousSelection, setPreviousSelection ] = useState( {} );\n\n\tuseEffect( () => {\n\t\tAnimated.timing( opacity, {\n\t\t\ttoValue: showFloatingToolbar ? 1 : 0,\n\t\t\tduration: showFloatingToolbar\n\t\t\t\t? EASE_IN_DURATION\n\t\t\t\t: EASE_OUT_DURATION,\n\t\t\teasing: Easing.ease,\n\t\t\tuseNativeDriver: true,\n\t\t} ).start();\n\t}, [ showFloatingToolbar ] );\n\n\tuseEffect( () => {\n\t\tif ( showFloatingToolbar )\n\t\t\tsetPreviousSelection( { clientId: selectedClientId, parentId } );\n\t}, [ selectedClientId ] );\n\n\tconst translationRange =\n\t\t( Platform.OS === 'android' ? -1 : 1 ) * TRANSLATION_RANGE;\n\n\tconst translation = opacity.interpolate( {\n\t\tinputRange: [ 0, 1 ],\n\t\toutputRange: [ translationRange, 0 ],\n\t} );\n\n\tconst animationStyle = {\n\t\topacity,\n\t\ttransform: [ { translateY: translation } ],\n\t};\n\n\tconst {\n\t\tclientId: previousSelectedClientId,\n\t\tparentId: previousSelectedParentId,\n\t} = previousSelection;\n\n\tconst showPrevious = previousSelectedClientId && ! showFloatingToolbar;\n\tconst blockSelectionButtonClientId = showPrevious\n\t\t? previousSelectedClientId\n\t\t: selectedClientId;\n\tconst showNavUpButton =\n\t\t!! parentId || ( showPrevious && !! previousSelectedParentId );\n\n\treturn (\n\t\t!! opacity && (\n\t\t\t<Animated.View style={ [ styles.floatingToolbar, animationStyle ] }>\n\t\t\t\t{ showNavUpButton && (\n\t\t\t\t\t<Toolbar passedStyle={ styles.toolbar }>\n\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\ttitle={ __( 'Navigate Up' ) }\n\t\t\t\t\t\t\tonClick={\n\t\t\t\t\t\t\t\t! showPrevious &&\n\t\t\t\t\t\t\t\t( () => onNavigateUp( parentId ) )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ticon={ <NavigateUpSVG isRTL={ isRTL } /> }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<View style={ styles.pipe } />\n\t\t\t\t\t</Toolbar>\n\t\t\t\t) }\n\t\t\t\t<BlockSelectionButton\n\t\t\t\t\tclientId={ blockSelectionButtonClientId }\n\t\t\t\t/>\n\t\t\t</Animated.View>\n\t\t)\n\t);\n};\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetBlockHierarchyRootClientId,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockCount,\n\t\t\tgetSettings,\n\t\t} = select( blockEditorStore );\n\n\t\tconst selectedClientId = getSelectedBlockClientId();\n\n\t\tif ( ! selectedClientId ) return;\n\n\t\tconst rootBlockId = getBlockHierarchyRootClientId( selectedClientId );\n\n\t\treturn {\n\t\t\tselectedClientId,\n\t\t\tshowFloatingToolbar: !! getBlockCount( rootBlockId ),\n\t\t\tparentId: getBlockRootClientId( selectedClientId ),\n\t\t\tisRTL: getSettings().isRTL,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { selectBlock } = dispatch( blockEditorStore );\n\n\t\treturn {\n\t\t\tonNavigateUp( clientId, initialPosition ) {\n\t\t\t\tselectBlock( clientId, initialPosition );\n\t\t\t},\n\t\t};\n\t} ),\n] )( FloatingToolbar );\n"]}