{"version":3,"sources":["@wordpress/block-editor/src/components/inserter/index.native.js"],"names":["AccessibilityInfo","Platform","delay","__","Dropdown","ToolbarButton","Picker","Component","withSelect","compose","withPreferredColorScheme","isUnmodifiedDefaultBlock","Icon","plusCircle","plusCircleFilled","insertAfter","insertBefore","styles","InserterMenu","BlockInsertionPoint","store","blockEditorStore","VOICE_OVER_ANNOUNCEMENT_DELAY","defaultRenderToggle","onToggle","disabled","style","onLongPress","color","hint","testID","Inserter","arguments","bind","renderToggle","renderContent","addBeforeOption","value","label","icon","replaceCurrentOption","addAfterOption","addToBeginningOption","addToEndOption","props","isAnyBlockSelected","isSelectedBlockReplaceable","insertionType","insertionIndexDefault","insertionIndexStart","insertionIndexBefore","insertionIndexAfter","insertionIndexEnd","isOpen","onInserterToggledAnnouncement","fetch","done","isEnabled","isIOS","OS","announcement","announceForAccessibility","getStylesFromColorScheme","showSeparator","addBlockButton","addBlockButtonDark","onPress","setState","destinationRootClientId","shouldReplaceBlock","insertionIndex","getInsertionIndex","picker","presentPicker","onPickerSelect","instance","getInsertionOptions","onClose","clientId","isAppender","state","select","rootClientId","getBlockRootClientId","getBlockSelectionEnd","getBlockOrder","getBlockIndex","getBlock","end","selectedBlockIndex","endOfRootIndex","length","isSelectedUnmodifiedDefaultBlock","undefined","getDefaultInsertionIndex","getSettings","shouldInsertAtTheTop","__experimentalShouldInsertAtTheTop"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { AccessibilityInfo, Platform } from 'react-native';\nimport { delay } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Dropdown, ToolbarButton, Picker } from '@wordpress/components';\nimport { Component } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport { isUnmodifiedDefaultBlock } from '@wordpress/blocks';\nimport {\n\tIcon,\n\tplusCircle,\n\tplusCircleFilled,\n\tinsertAfter,\n\tinsertBefore,\n} from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport InserterMenu from './menu';\nimport BlockInsertionPoint from '../block-list/insertion-point';\nimport { store as blockEditorStore } from '../../store';\n\nconst VOICE_OVER_ANNOUNCEMENT_DELAY = 1000;\n\nconst defaultRenderToggle = ( { onToggle, disabled, style, onLongPress } ) => (\n\t<ToolbarButton\n\t\ttitle={ __( 'Add block' ) }\n\t\ticon={\n\t\t\t<Icon\n\t\t\t\ticon={ plusCircleFilled }\n\t\t\t\tstyle={ style }\n\t\t\t\tcolor={ style.color }\n\t\t\t/>\n\t\t}\n\t\tonClick={ onToggle }\n\t\textraProps={ {\n\t\t\thint: __( 'Double tap to add a block' ),\n\t\t\t// testID is present to disambiguate this element for native UI tests. It's not\n\t\t\t// usually required for components. See: https://git.io/JeQ7G.\n\t\t\ttestID: 'add-block-button',\n\t\t\tonLongPress,\n\t\t} }\n\t\tisDisabled={ disabled }\n\t/>\n);\n\nexport class Inserter extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onToggle = this.onToggle.bind( this );\n\t\tthis.renderToggle = this.renderToggle.bind( this );\n\t\tthis.renderContent = this.renderContent.bind( this );\n\t}\n\n\tgetInsertionOptions() {\n\t\tconst addBeforeOption = {\n\t\t\tvalue: 'before',\n\t\t\tlabel: __( 'Add Block Before' ),\n\t\t\ticon: plusCircle,\n\t\t};\n\n\t\tconst replaceCurrentOption = {\n\t\t\tvalue: 'replace',\n\t\t\tlabel: __( 'Replace Current Block' ),\n\t\t\ticon: plusCircleFilled,\n\t\t};\n\n\t\tconst addAfterOption = {\n\t\t\tvalue: 'after',\n\t\t\tlabel: __( 'Add Block After' ),\n\t\t\ticon: plusCircle,\n\t\t};\n\n\t\tconst addToBeginningOption = {\n\t\t\tvalue: 'start',\n\t\t\tlabel: __( 'Add To Beginning' ),\n\t\t\ticon: insertBefore,\n\t\t};\n\n\t\tconst addToEndOption = {\n\t\t\tvalue: 'end',\n\t\t\tlabel: __( 'Add To End' ),\n\t\t\ticon: insertAfter,\n\t\t};\n\n\t\tconst { isAnyBlockSelected, isSelectedBlockReplaceable } = this.props;\n\t\tif ( isAnyBlockSelected ) {\n\t\t\tif ( isSelectedBlockReplaceable ) {\n\t\t\t\treturn [\n\t\t\t\t\taddToBeginningOption,\n\t\t\t\t\taddBeforeOption,\n\t\t\t\t\treplaceCurrentOption,\n\t\t\t\t\taddAfterOption,\n\t\t\t\t\taddToEndOption,\n\t\t\t\t];\n\t\t\t}\n\t\t\treturn [\n\t\t\t\taddToBeginningOption,\n\t\t\t\taddBeforeOption,\n\t\t\t\taddAfterOption,\n\t\t\t\taddToEndOption,\n\t\t\t];\n\t\t}\n\t\treturn [ addToBeginningOption, addToEndOption ];\n\t}\n\n\tgetInsertionIndex( insertionType ) {\n\t\tconst {\n\t\t\tinsertionIndexDefault,\n\t\t\tinsertionIndexStart,\n\t\t\tinsertionIndexBefore,\n\t\t\tinsertionIndexAfter,\n\t\t\tinsertionIndexEnd,\n\t\t} = this.props;\n\t\tif ( insertionType === 'start' ) {\n\t\t\treturn insertionIndexStart;\n\t\t}\n\t\tif ( insertionType === 'before' || insertionType === 'replace' ) {\n\t\t\treturn insertionIndexBefore;\n\t\t}\n\t\tif ( insertionType === 'after' ) {\n\t\t\treturn insertionIndexAfter;\n\t\t}\n\t\tif ( insertionType === 'end' ) {\n\t\t\treturn insertionIndexEnd;\n\t\t}\n\t\treturn insertionIndexDefault;\n\t}\n\n\tshouldReplaceBlock( insertionType ) {\n\t\tconst { isSelectedBlockReplaceable } = this.props;\n\t\tif ( insertionType === 'replace' ) {\n\t\t\treturn true;\n\t\t}\n\t\tif ( insertionType === 'default' && isSelectedBlockReplaceable ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tonToggle( isOpen ) {\n\t\tconst { onToggle } = this.props;\n\n\t\t// Surface toggle callback to parent component\n\t\tif ( onToggle ) {\n\t\t\tonToggle( isOpen );\n\t\t}\n\t\tthis.onInserterToggledAnnouncement( isOpen );\n\t}\n\n\tonInserterToggledAnnouncement( isOpen ) {\n\t\tAccessibilityInfo.fetch().done( ( isEnabled ) => {\n\t\t\tif ( isEnabled ) {\n\t\t\t\tconst isIOS = Platform.OS === 'ios';\n\t\t\t\tconst announcement = isOpen\n\t\t\t\t\t? __( 'Scrollable block menu opened. Select a block.' )\n\t\t\t\t\t: __( 'Scrollable block menu closed.' );\n\t\t\t\tdelay(\n\t\t\t\t\t() =>\n\t\t\t\t\t\tAccessibilityInfo.announceForAccessibility(\n\t\t\t\t\t\t\tannouncement\n\t\t\t\t\t\t),\n\t\t\t\t\tisIOS ? VOICE_OVER_ANNOUNCEMENT_DELAY : 0\n\t\t\t\t);\n\t\t\t}\n\t\t} );\n\t}\n\n\t/**\n\t * Render callback to display Dropdown toggle element.\n\t *\n\t * @param {Object}   options\n\t * @param {Function} options.onToggle Callback to invoke when toggle is\n\t *                                    pressed.\n\t * @param {boolean}  options.isOpen   Whether dropdown is currently open.\n\t *\n\t * @return {WPElement} Dropdown toggle element.\n\t */\n\trenderToggle( { onToggle, isOpen } ) {\n\t\tconst {\n\t\t\tdisabled,\n\t\t\trenderToggle = defaultRenderToggle,\n\t\t\tgetStylesFromColorScheme,\n\t\t\tshowSeparator,\n\t\t} = this.props;\n\t\tif ( showSeparator && isOpen ) {\n\t\t\treturn <BlockInsertionPoint />;\n\t\t}\n\t\tconst style = getStylesFromColorScheme(\n\t\t\tstyles.addBlockButton,\n\t\t\tstyles.addBlockButtonDark\n\t\t);\n\n\t\tconst onPress = () => {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tdestinationRootClientId: this.props.destinationRootClientId,\n\t\t\t\t\tshouldReplaceBlock: this.shouldReplaceBlock( 'default' ),\n\t\t\t\t\tinsertionIndex: this.getInsertionIndex( 'default' ),\n\t\t\t\t},\n\t\t\t\tonToggle\n\t\t\t);\n\t\t};\n\n\t\tconst onLongPress = () => {\n\t\t\tif ( this.picker ) {\n\t\t\t\tthis.picker.presentPicker();\n\t\t\t}\n\t\t};\n\n\t\tconst onPickerSelect = ( insertionType ) => {\n\t\t\tthis.setState(\n\t\t\t\t{\n\t\t\t\t\tdestinationRootClientId: this.props.destinationRootClientId,\n\t\t\t\t\tshouldReplaceBlock: this.shouldReplaceBlock(\n\t\t\t\t\t\tinsertionType\n\t\t\t\t\t),\n\t\t\t\t\tinsertionIndex: this.getInsertionIndex( insertionType ),\n\t\t\t\t},\n\t\t\t\tonToggle\n\t\t\t);\n\t\t};\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{ renderToggle( {\n\t\t\t\t\tonToggle: onPress,\n\t\t\t\t\tisOpen,\n\t\t\t\t\tdisabled,\n\t\t\t\t\tstyle,\n\t\t\t\t\tonLongPress,\n\t\t\t\t} ) }\n\t\t\t\t<Picker\n\t\t\t\t\tref={ ( instance ) => ( this.picker = instance ) }\n\t\t\t\t\toptions={ this.getInsertionOptions() }\n\t\t\t\t\tonChange={ onPickerSelect }\n\t\t\t\t\thideCancelButton\n\t\t\t\t/>\n\t\t\t</>\n\t\t);\n\t}\n\n\t/**\n\t * Render callback to display Dropdown content element.\n\t *\n\t * @param {Object}   options\n\t * @param {Function} options.onClose Callback to invoke when dropdown is\n\t *                                   closed.\n\t * @param {boolean}  options.isOpen  Whether dropdown is currently open.\n\t *\n\t * @return {WPElement} Dropdown content element.\n\t */\n\trenderContent( { onClose, isOpen } ) {\n\t\tconst { clientId, isAppender } = this.props;\n\t\tconst {\n\t\t\tdestinationRootClientId,\n\t\t\tshouldReplaceBlock,\n\t\t\tinsertionIndex,\n\t\t} = this.state;\n\t\treturn (\n\t\t\t<InserterMenu\n\t\t\t\tisOpen={ isOpen }\n\t\t\t\tonSelect={ onClose }\n\t\t\t\tonDismiss={ onClose }\n\t\t\t\trootClientId={ destinationRootClientId }\n\t\t\t\tclientId={ clientId }\n\t\t\t\tisAppender={ isAppender }\n\t\t\t\tshouldReplaceBlock={ shouldReplaceBlock }\n\t\t\t\tinsertionIndex={ insertionIndex }\n\t\t\t/>\n\t\t);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Dropdown\n\t\t\t\tonToggle={ this.onToggle }\n\t\t\t\theaderTitle={ __( 'Add a block' ) }\n\t\t\t\trenderToggle={ this.renderToggle }\n\t\t\t\trenderContent={ this.renderContent }\n\t\t\t/>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientId, isAppender, rootClientId } ) => {\n\t\tconst {\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockSelectionEnd,\n\t\t\tgetBlockOrder,\n\t\t\tgetBlockIndex,\n\t\t\tgetBlock,\n\t\t} = select( blockEditorStore );\n\n\t\tconst end = getBlockSelectionEnd();\n\t\t// `end` argument (id) can refer to the component which is removed\n\t\t// due to pressing `undo` button, that's why we need to check\n\t\t// if `getBlock( end) is valid, otherwise `null` is passed\n\t\tconst isAnyBlockSelected = ! isAppender && end && getBlock( end );\n\t\tconst destinationRootClientId = isAnyBlockSelected\n\t\t\t? getBlockRootClientId( end )\n\t\t\t: rootClientId;\n\t\tconst selectedBlockIndex = getBlockIndex(\n\t\t\tend,\n\t\t\tdestinationRootClientId\n\t\t);\n\t\tconst endOfRootIndex = getBlockOrder( rootClientId ).length;\n\t\tconst isSelectedUnmodifiedDefaultBlock = isAnyBlockSelected\n\t\t\t? isUnmodifiedDefaultBlock( getBlock( end ) )\n\t\t\t: undefined;\n\n\t\tfunction getDefaultInsertionIndex() {\n\t\t\tconst { getSettings } = select( blockEditorStore );\n\n\t\t\tconst {\n\t\t\t\t__experimentalShouldInsertAtTheTop: shouldInsertAtTheTop,\n\t\t\t} = getSettings();\n\n\t\t\t// if post title is selected insert as first block\n\t\t\tif ( shouldInsertAtTheTop ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\t// If the clientId is defined, we insert at the position of the block.\n\t\t\tif ( clientId ) {\n\t\t\t\treturn getBlockIndex( clientId, rootClientId );\n\t\t\t}\n\n\t\t\t// If there is a selected block,\n\t\t\tif ( isAnyBlockSelected ) {\n\t\t\t\t// and the last selected block is unmodified (empty), it will be replaced\n\t\t\t\tif ( isSelectedUnmodifiedDefaultBlock ) {\n\t\t\t\t\treturn selectedBlockIndex;\n\t\t\t\t}\n\n\t\t\t\t// we insert after the selected block.\n\t\t\t\treturn selectedBlockIndex + 1;\n\t\t\t}\n\n\t\t\t// Otherwise, we insert at the end of the current rootClientId\n\t\t\treturn endOfRootIndex;\n\t\t}\n\n\t\tconst insertionIndexStart = 0;\n\n\t\tconst insertionIndexBefore = isAnyBlockSelected\n\t\t\t? selectedBlockIndex\n\t\t\t: insertionIndexStart;\n\n\t\tconst insertionIndexAfter = isAnyBlockSelected\n\t\t\t? selectedBlockIndex + 1\n\t\t\t: endOfRootIndex;\n\n\t\tconst insertionIndexEnd = endOfRootIndex;\n\n\t\treturn {\n\t\t\tdestinationRootClientId,\n\t\t\tinsertionIndexDefault: getDefaultInsertionIndex(),\n\t\t\tinsertionIndexBefore,\n\t\t\tinsertionIndexAfter,\n\t\t\tinsertionIndexStart,\n\t\t\tinsertionIndexEnd,\n\t\t\tisAnyBlockSelected: !! isAnyBlockSelected,\n\t\t\tisSelectedBlockReplaceable: isSelectedUnmodifiedDefaultBlock,\n\t\t};\n\t} ),\n\n\twithPreferredColorScheme,\n] )( Inserter );\n"]}