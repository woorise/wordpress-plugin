"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.usePreParsePatterns = usePreParsePatterns;

var _data = require("@wordpress/data");

var _element = require("@wordpress/element");

var _store = require("../store");

/**
 * WordPress dependencies
 */

/**
 * Internal dependencies
 */
var requestIdleCallback = function () {
  if (typeof window === 'undefined') {
    return function (callback) {
      setTimeout(function () {
        return callback(Date.now());
      }, 0);
    };
  }

  return window.requestIdleCallback || window.requestAnimationFrame;
}();

var cancelIdleCallback = function () {
  if (typeof window === 'undefined') {
    return clearTimeout;
  }

  return window.cancelIdleCallback || window.cancelAnimationFrame;
}();

function usePreParsePatterns() {
  var patterns = (0, _data.useSelect)(function (_select) {
    return _select(_store.store).getSettings().__experimentalBlockPatterns;
  }, []);
  (0, _element.useEffect)(function () {
    if (!(patterns !== null && patterns !== void 0 && patterns.length)) {
      return;
    }

    var handle;
    var index = -1;

    var callback = function callback() {
      index++;

      if (index >= patterns.length) {
        return;
      }

      (0, _data.select)(_store.store).__experimentalGetParsedPattern(patterns[index].name);

      handle = requestIdleCallback(callback);
    };

    handle = requestIdleCallback(callback);
    return function () {
      return cancelIdleCallback(handle);
    };
  }, [patterns]);
  return null;
}
//# sourceMappingURL=pre-parse-patterns.js.map