"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = EditorStyles;

var _element = require("@wordpress/element");

var _tinycolor = _interopRequireDefault(require("tinycolor2"));

var _transformStyles = _interopRequireDefault(require("../../utils/transform-styles"));

/**
 * External dependencies
 */

/**
 * WordPress dependencies
 */

/**
 * Internal dependencies
 */
var EDITOR_STYLES_SELECTOR = '.editor-styles-wrapper';

function useDarkThemeBodyClassName(styles) {
  return (0, _element.useCallback)(function (node) {
    if (!node) {
      return;
    }

    var ownerDocument = node.ownerDocument;
    var defaultView = ownerDocument.defaultView,
        body = ownerDocument.body;
    var canvas = ownerDocument.querySelector(EDITOR_STYLES_SELECTOR);
    var backgroundColor = defaultView.getComputedStyle(canvas, null).getPropertyValue('background-color');

    if ((0, _tinycolor.default)(backgroundColor).getLuminance() > 0.5) {
      body.classList.remove('is-dark-theme');
    } else {
      body.classList.add('is-dark-theme');
    }
  }, [styles]);
}

function EditorStyles(_ref) {
  var styles = _ref.styles;
  return (0, _element.createElement)(_element.Fragment, null, (0, _element.createElement)("style", {
    ref: useDarkThemeBodyClassName(styles)
  }), (0, _transformStyles.default)(styles, EDITOR_STYLES_SELECTOR).map(function (css, index) {
    return (0, _element.createElement)("style", {
      key: index
    }, css);
  }));
}
//# sourceMappingURL=index.js.map