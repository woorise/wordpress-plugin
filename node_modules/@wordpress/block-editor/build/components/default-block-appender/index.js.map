{"version":3,"sources":["@wordpress/block-editor/src/components/default-block-appender/index.js"],"names":["DefaultBlockAppender","isLocked","isVisible","onAppend","showPrompt","placeholder","rootClientId","value","select","ownProps","blockEditorStore","getBlockCount","getBlockName","isBlockValid","getSettings","getTemplateLock","isEmpty","isLastBlockDefault","lastBlockClientId","isLastBlockValid","bodyPlaceholder","dispatch","insertDefaultBlock","startTyping","undefined"],"mappings":";;;;;;;;;;;;AAGA;;AAKA;;AACA;;AACA;;AACA;;AACA;;AAKA;;AACA;;AAlBA;AACA;AACA;;AAGA;AACA;AACA;;AAOA;AACA;AACA;AAIO,SAASA,oBAAT,OAOH;AAAA,MANHC,QAMG,QANHA,QAMG;AAAA,MALHC,SAKG,QALHA,SAKG;AAAA,MAJHC,QAIG,QAJHA,QAIG;AAAA,MAHHC,UAGG,QAHHA,UAGG;AAAA,MAFHC,WAEG,QAFHA,WAEG;AAAA,MADHC,YACG,QADHA,YACG;;AACH,MAAKL,QAAQ,IAAI,CAAEC,SAAnB,EAA+B;AAC9B,WAAO,IAAP;AACA;;AAED,MAAMK,KAAK,GACV,kCAAgBF,WAAhB,KACA,cAAI,2CAAJ,CAFD,CALG,CASH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAEA,SACC;AACC,2BAAsBC,YAAY,IAAI,EADvC;AAEC,IAAA,SAAS,EAAC;AAFX,KAIC,4BAAC,8BAAD;AACC,IAAA,IAAI,EAAC,QADN;AAEC,kBAAa,cAAI,WAAJ,CAFd;AAGC,IAAA,SAAS,EAAC,8CAHX;AAIC,IAAA,QAAQ,MAJT;AAKC,IAAA,OAAO,EAAGH,QALX;AAMC,IAAA,KAAK,EAAGC,UAAU,GAAGG,KAAH,GAAW;AAN9B,IAJD,EAYC,4BAAC,iBAAD;AACC,IAAA,YAAY,EAAGD,YADhB;AAEC,IAAA,QAAQ,EAAC,cAFV;AAGC,IAAA,UAAU,MAHX;AAIC,IAAA,qBAAqB;AAJtB,IAZD,CADD;AAqBA;;eAEc,sBACd,sBAAY,UAAEE,MAAF,EAAUC,QAAV,EAAwB;AAAA,gBAO/BD,MAAM,CAAEE,YAAF,CAPyB;AAAA,MAElCC,aAFkC,WAElCA,aAFkC;AAAA,MAGlCC,YAHkC,WAGlCA,YAHkC;AAAA,MAIlCC,YAJkC,WAIlCA,YAJkC;AAAA,MAKlCC,WALkC,WAKlCA,WALkC;AAAA,MAMlCC,eANkC,WAMlCA,eANkC;;AASnC,MAAMC,OAAO,GAAG,CAAEL,aAAa,CAAEF,QAAQ,CAACH,YAAX,CAA/B;AACA,MAAMW,kBAAkB,GACvBL,YAAY,CAAEH,QAAQ,CAACS,iBAAX,CAAZ,KACA,kCAFD;AAGA,MAAMC,gBAAgB,GAAGN,YAAY,CAAEJ,QAAQ,CAACS,iBAAX,CAArC;;AAbmC,qBAcPJ,WAAW,EAdJ;AAAA,MAc3BM,eAd2B,gBAc3BA,eAd2B;;AAgBnC,SAAO;AACNlB,IAAAA,SAAS,EAAEc,OAAO,IAAI,CAAEC,kBAAb,IAAmC,CAAEE,gBAD1C;AAENf,IAAAA,UAAU,EAAEY,OAFN;AAGNf,IAAAA,QAAQ,EAAE,CAAC,CAAEc,eAAe,CAAEN,QAAQ,CAACH,YAAX,CAHtB;AAIND,IAAAA,WAAW,EAAEe;AAJP,GAAP;AAMA,CAtBD,CADc,EAwBd,wBAAc,UAAEC,QAAF,EAAYZ,QAAZ,EAA0B;AAAA,kBACKY,QAAQ,CACnDX,YADmD,CADb;AAAA,MAC/BY,kBAD+B,aAC/BA,kBAD+B;AAAA,MACXC,WADW,aACXA,WADW;;AAKvC,SAAO;AACNpB,IAAAA,QADM,sBACK;AAAA,UACFG,YADE,GACeG,QADf,CACFH,YADE;AAGVgB,MAAAA,kBAAkB,CAAEE,SAAF,EAAalB,YAAb,CAAlB;AACAiB,MAAAA,WAAW;AACX;AANK,GAAP;AAQA,CAbD,CAxBc,EAsCZvB,oBAtCY,C","sourcesContent":["/**\n * External dependencies\n */\nimport TextareaAutosize from 'react-autosize-textarea';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { compose } from '@wordpress/compose';\nimport { getDefaultBlockName } from '@wordpress/blocks';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { withSelect, withDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport Inserter from '../inserter';\nimport { store as blockEditorStore } from '../../store';\n\nexport function DefaultBlockAppender( {\n\tisLocked,\n\tisVisible,\n\tonAppend,\n\tshowPrompt,\n\tplaceholder,\n\trootClientId,\n} ) {\n\tif ( isLocked || ! isVisible ) {\n\t\treturn null;\n\t}\n\n\tconst value =\n\t\tdecodeEntities( placeholder ) ||\n\t\t__( 'Start writing or type / to choose a block' );\n\n\t// The appender \"button\" is in-fact a text field so as to support\n\t// transitions by WritingFlow occurring by arrow key press. WritingFlow\n\t// only supports tab transitions into text fields and to the block focus\n\t// boundary.\n\t//\n\t// See: https://github.com/WordPress/gutenberg/issues/4829#issuecomment-374213658\n\t//\n\t// If it were ever to be made to be a proper `button` element, it is\n\t// important to note that `onFocus` alone would not be sufficient to\n\t// capture click events, notably in Firefox.\n\t//\n\t// See: https://gist.github.com/cvrebert/68659d0333a578d75372\n\n\t// The wp-block className is important for editor styles.\n\n\treturn (\n\t\t<div\n\t\t\tdata-root-client-id={ rootClientId || '' }\n\t\t\tclassName=\"wp-block block-editor-default-block-appender\"\n\t\t>\n\t\t\t<TextareaAutosize\n\t\t\t\trole=\"button\"\n\t\t\t\taria-label={ __( 'Add block' ) }\n\t\t\t\tclassName=\"block-editor-default-block-appender__content\"\n\t\t\t\treadOnly\n\t\t\t\tonFocus={ onAppend }\n\t\t\t\tvalue={ showPrompt ? value : '' }\n\t\t\t/>\n\t\t\t<Inserter\n\t\t\t\trootClientId={ rootClientId }\n\t\t\t\tposition=\"bottom right\"\n\t\t\t\tisAppender\n\t\t\t\t__experimentalIsQuick\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nexport default compose(\n\twithSelect( ( select, ownProps ) => {\n\t\tconst {\n\t\t\tgetBlockCount,\n\t\t\tgetBlockName,\n\t\t\tisBlockValid,\n\t\t\tgetSettings,\n\t\t\tgetTemplateLock,\n\t\t} = select( blockEditorStore );\n\n\t\tconst isEmpty = ! getBlockCount( ownProps.rootClientId );\n\t\tconst isLastBlockDefault =\n\t\t\tgetBlockName( ownProps.lastBlockClientId ) ===\n\t\t\tgetDefaultBlockName();\n\t\tconst isLastBlockValid = isBlockValid( ownProps.lastBlockClientId );\n\t\tconst { bodyPlaceholder } = getSettings();\n\n\t\treturn {\n\t\t\tisVisible: isEmpty || ! isLastBlockDefault || ! isLastBlockValid,\n\t\t\tshowPrompt: isEmpty,\n\t\t\tisLocked: !! getTemplateLock( ownProps.rootClientId ),\n\t\t\tplaceholder: bodyPlaceholder,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, ownProps ) => {\n\t\tconst { insertDefaultBlock, startTyping } = dispatch(\n\t\t\tblockEditorStore\n\t\t);\n\n\t\treturn {\n\t\t\tonAppend() {\n\t\t\t\tconst { rootClientId } = ownProps;\n\n\t\t\t\tinsertDefaultBlock( undefined, rootClientId );\n\t\t\t\tstartTyping();\n\t\t\t},\n\t\t};\n\t} )\n)( DefaultBlockAppender );\n"]}