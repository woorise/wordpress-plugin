{"version":3,"sources":["@wordpress/components/src/mobile/audio-player/index.native.js"],"names":["isIOS","Platform","OS","Player","getStylesFromColorScheme","isUploadInProgress","isUploadFailed","attributes","isSelected","id","src","paused","setPaused","onPressListen","player","presentFullscreenPlayer","Linking","canOpenURL","then","supported","Alert","alert","openURL","catch","containerStyle","styles","container","containerDark","iconStyle","icon","iconDark","iconDisabledStyle","iconDisabled","iconDisabledDark","isDisabled","finalIconStyle","iconContainerStyle","iconContainer","iconContainerDark","titleContainerStyle","titleContainer","titleContainerIOS","titleContainerAndroid","titleStyle","title","titleDark","uploadFailedStyle","uploadFailed","uploadFailedDark","subtitleStyle","subtitle","subtitleDark","finalSubtitleStyle","buttonBackgroundStyle","buttonBackground","buttonBackgroundDark","extension","decodedURI","fileName","split","pop","parts","toUpperCase","join","getSubtitleValue","onAudioUploadCancelDialog","audio","subtitleContainer","warning","errorIcon","buttonText","uri","ref"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tText,\n\tTouchableWithoutFeedback,\n\tLinking,\n\tAlert,\n\tPlatform,\n} from 'react-native';\nimport { default as VideoPlayer } from 'react-native-video';\n\n/**\n * WordPress dependencies\n */\nimport { View } from '@wordpress/primitives';\nimport { Icon } from '@wordpress/components';\nimport { withPreferredColorScheme } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\nimport { audio, warning } from '@wordpress/icons';\nimport {\n\trequestImageFailedRetryDialog,\n\trequestImageUploadCancelDialog,\n} from '@wordpress/react-native-bridge';\nimport { getProtocol, safeDecodeURI } from '@wordpress/url';\nimport { useState } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\n\nconst isIOS = Platform.OS === 'ios';\n\nfunction Player( {\n\tgetStylesFromColorScheme,\n\tisUploadInProgress,\n\tisUploadFailed,\n\tattributes,\n\tisSelected,\n} ) {\n\tconst { id, src } = attributes;\n\tconst [ paused, setPaused ] = useState( true );\n\n\tconst onPressListen = () => {\n\t\tif ( src ) {\n\t\t\tif ( isIOS && this.player ) {\n\t\t\t\tthis.player.presentFullscreenPlayer();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLinking.canOpenURL( src )\n\t\t\t\t.then( ( supported ) => {\n\t\t\t\t\tif ( ! supported ) {\n\t\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t\t__( 'Problem opening the audio' ),\n\t\t\t\t\t\t\t__( 'No application can handle this request.' )\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn Linking.openURL( src );\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t\t\t.catch( () => {\n\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t__( 'Problem opening the audio' ),\n\t\t\t\t\t\t__( 'An unknown error occurred. Please try again.' )\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t}\n\t};\n\n\tconst containerStyle = getStylesFromColorScheme(\n\t\tstyles.container,\n\t\tstyles.containerDark\n\t);\n\n\tconst iconStyle = getStylesFromColorScheme( styles.icon, styles.iconDark );\n\n\tconst iconDisabledStyle = getStylesFromColorScheme(\n\t\tstyles.iconDisabled,\n\t\tstyles.iconDisabledDark\n\t);\n\n\tconst isDisabled = isUploadFailed || isUploadInProgress;\n\n\tconst finalIconStyle = {\n\t\t...iconStyle,\n\t\t...( isDisabled && iconDisabledStyle ),\n\t};\n\n\tconst iconContainerStyle = getStylesFromColorScheme(\n\t\tstyles.iconContainer,\n\t\tstyles.iconContainerDark\n\t);\n\n\tconst titleContainerStyle = {\n\t\t...styles.titleContainer,\n\t\t...( isIOS ? styles.titleContainerIOS : styles.titleContainerAndroid ),\n\t};\n\n\tconst titleStyle = getStylesFromColorScheme(\n\t\tstyles.title,\n\t\tstyles.titleDark\n\t);\n\n\tconst uploadFailedStyle = getStylesFromColorScheme(\n\t\tstyles.uploadFailed,\n\t\tstyles.uploadFailedDark\n\t);\n\n\tconst subtitleStyle = getStylesFromColorScheme(\n\t\tstyles.subtitle,\n\t\tstyles.subtitleDark\n\t);\n\n\tconst finalSubtitleStyle = {\n\t\t...subtitleStyle,\n\t\t...( isUploadFailed && uploadFailedStyle ),\n\t};\n\n\tconst buttonBackgroundStyle = getStylesFromColorScheme(\n\t\tstyles.buttonBackground,\n\t\tstyles.buttonBackgroundDark\n\t);\n\n\tlet title = '';\n\tlet extension = '';\n\n\tif ( src ) {\n\t\tconst decodedURI = safeDecodeURI( src );\n\t\tconst fileName = decodedURI.split( '/' ).pop();\n\t\tconst parts = fileName.split( '.' );\n\t\textension = parts.pop().toUpperCase();\n\t\ttitle = parts.join( '.' );\n\t}\n\n\tconst getSubtitleValue = () => {\n\t\tif ( isUploadInProgress ) {\n\t\t\treturn __( 'Uploadingâ€¦' );\n\t\t}\n\t\tif ( isUploadFailed ) {\n\t\t\treturn __( 'Failed to insert audio file. Please tap for options.' );\n\t\t}\n\t\treturn (\n\t\t\textension +\n\t\t\t// translators: displays audio file extension. e.g. MP3 audio file\n\t\t\t__( ' audio file' )\n\t\t);\n\t};\n\n\tfunction onAudioUploadCancelDialog() {\n\t\tif ( isUploadInProgress ) {\n\t\t\trequestImageUploadCancelDialog( id );\n\t\t} else if ( id && getProtocol( src ) === 'file:' ) {\n\t\t\trequestImageFailedRetryDialog( id );\n\t\t}\n\t}\n\n\treturn (\n\t\t<TouchableWithoutFeedback\n\t\t\taccessible={ ! isSelected }\n\t\t\tdisabled={ ! isSelected }\n\t\t\tonPress={ onAudioUploadCancelDialog }\n\t\t>\n\t\t\t<View style={ containerStyle }>\n\t\t\t\t<View style={ iconContainerStyle }>\n\t\t\t\t\t<Icon icon={ audio } style={ finalIconStyle } size={ 24 } />\n\t\t\t\t</View>\n\t\t\t\t<View style={ titleContainerStyle }>\n\t\t\t\t\t<Text style={ titleStyle }>{ title }</Text>\n\t\t\t\t\t<View style={ styles.subtitleContainer }>\n\t\t\t\t\t\t{ isUploadFailed && (\n\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\ticon={ warning }\n\t\t\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t\t\t...styles.errorIcon,\n\t\t\t\t\t\t\t\t\t...uploadFailedStyle,\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\tsize={ 16 }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<Text style={ finalSubtitleStyle }>\n\t\t\t\t\t\t\t{ getSubtitleValue() }\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</View>\n\t\t\t\t</View>\n\t\t\t\t{ ! isDisabled && (\n\t\t\t\t\t<TouchableWithoutFeedback\n\t\t\t\t\t\taccessibilityLabel={ __( 'Audio Player' ) }\n\t\t\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t\t\t\taccessibilityHint={ __(\n\t\t\t\t\t\t\t'Double tap to listen the audio file'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonPress={ onPressListen }\n\t\t\t\t\t>\n\t\t\t\t\t\t<View style={ buttonBackgroundStyle }>\n\t\t\t\t\t\t\t<Text style={ styles.buttonText }>\n\t\t\t\t\t\t\t\t{ __( 'OPEN' ) }\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</TouchableWithoutFeedback>\n\t\t\t\t) }\n\t\t\t\t{ isIOS && (\n\t\t\t\t\t<VideoPlayer\n\t\t\t\t\t\tsource={ { uri: src } }\n\t\t\t\t\t\tpaused={ paused }\n\t\t\t\t\t\tref={ ( ref ) => {\n\t\t\t\t\t\t\tthis.player = ref;\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tcontrols={ false }\n\t\t\t\t\t\tignoreSilentSwitch={ 'ignore' }\n\t\t\t\t\t\tonFullscreenPlayerWillPresent={ () => {\n\t\t\t\t\t\t\tsetPaused( false );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonFullscreenPlayerDidDismiss={ () => {\n\t\t\t\t\t\t\tsetPaused( true );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n}\n\nexport default withPreferredColorScheme( Player );\n"]}