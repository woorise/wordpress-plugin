{"version":3,"sources":["@wordpress/components/src/mobile/audio-player/index.native.js"],"names":["Text","TouchableWithoutFeedback","Linking","Alert","Platform","default","VideoPlayer","View","Icon","withPreferredColorScheme","__","audio","warning","requestImageFailedRetryDialog","requestImageUploadCancelDialog","getProtocol","safeDecodeURI","useState","styles","isIOS","OS","Player","getStylesFromColorScheme","isUploadInProgress","isUploadFailed","attributes","isSelected","id","src","paused","setPaused","onPressListen","player","presentFullscreenPlayer","canOpenURL","then","supported","alert","openURL","catch","containerStyle","container","containerDark","iconStyle","icon","iconDark","iconDisabledStyle","iconDisabled","iconDisabledDark","isDisabled","finalIconStyle","iconContainerStyle","iconContainer","iconContainerDark","titleContainerStyle","titleContainer","titleContainerIOS","titleContainerAndroid","titleStyle","title","titleDark","uploadFailedStyle","uploadFailed","uploadFailedDark","subtitleStyle","subtitle","subtitleDark","finalSubtitleStyle","buttonBackgroundStyle","buttonBackground","buttonBackgroundDark","extension","decodedURI","fileName","split","pop","parts","toUpperCase","join","getSubtitleValue","onAudioUploadCancelDialog","subtitleContainer","errorIcon","buttonText","uri","ref"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tText,\n\tTouchableWithoutFeedback,\n\tLinking,\n\tAlert,\n\tPlatform,\n} from 'react-native';\nimport { default as VideoPlayer } from 'react-native-video';\n\n/**\n * WordPress dependencies\n */\nimport { View } from '@wordpress/primitives';\nimport { Icon } from '@wordpress/components';\nimport { withPreferredColorScheme } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\nimport { audio, warning } from '@wordpress/icons';\nimport {\n\trequestImageFailedRetryDialog,\n\trequestImageUploadCancelDialog,\n} from '@wordpress/react-native-bridge';\nimport { getProtocol, safeDecodeURI } from '@wordpress/url';\nimport { useState } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\n\nconst isIOS = Platform.OS === 'ios';\n\nfunction Player( {\n\tgetStylesFromColorScheme,\n\tisUploadInProgress,\n\tisUploadFailed,\n\tattributes,\n\tisSelected,\n} ) {\n\tconst { id, src } = attributes;\n\tconst [ paused, setPaused ] = useState( true );\n\n\tconst onPressListen = () => {\n\t\tif ( src ) {\n\t\t\tif ( isIOS && this.player ) {\n\t\t\t\tthis.player.presentFullscreenPlayer();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLinking.canOpenURL( src )\n\t\t\t\t.then( ( supported ) => {\n\t\t\t\t\tif ( ! supported ) {\n\t\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t\t__( 'Problem opening the audio' ),\n\t\t\t\t\t\t\t__( 'No application can handle this request.' )\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn Linking.openURL( src );\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t\t\t.catch( () => {\n\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t__( 'Problem opening the audio' ),\n\t\t\t\t\t\t__( 'An unknown error occurred. Please try again.' )\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t}\n\t};\n\n\tconst containerStyle = getStylesFromColorScheme(\n\t\tstyles.container,\n\t\tstyles.containerDark\n\t);\n\n\tconst iconStyle = getStylesFromColorScheme( styles.icon, styles.iconDark );\n\n\tconst iconDisabledStyle = getStylesFromColorScheme(\n\t\tstyles.iconDisabled,\n\t\tstyles.iconDisabledDark\n\t);\n\n\tconst isDisabled = isUploadFailed || isUploadInProgress;\n\n\tconst finalIconStyle = {\n\t\t...iconStyle,\n\t\t...( isDisabled && iconDisabledStyle ),\n\t};\n\n\tconst iconContainerStyle = getStylesFromColorScheme(\n\t\tstyles.iconContainer,\n\t\tstyles.iconContainerDark\n\t);\n\n\tconst titleContainerStyle = {\n\t\t...styles.titleContainer,\n\t\t...( isIOS ? styles.titleContainerIOS : styles.titleContainerAndroid ),\n\t};\n\n\tconst titleStyle = getStylesFromColorScheme(\n\t\tstyles.title,\n\t\tstyles.titleDark\n\t);\n\n\tconst uploadFailedStyle = getStylesFromColorScheme(\n\t\tstyles.uploadFailed,\n\t\tstyles.uploadFailedDark\n\t);\n\n\tconst subtitleStyle = getStylesFromColorScheme(\n\t\tstyles.subtitle,\n\t\tstyles.subtitleDark\n\t);\n\n\tconst finalSubtitleStyle = {\n\t\t...subtitleStyle,\n\t\t...( isUploadFailed && uploadFailedStyle ),\n\t};\n\n\tconst buttonBackgroundStyle = getStylesFromColorScheme(\n\t\tstyles.buttonBackground,\n\t\tstyles.buttonBackgroundDark\n\t);\n\n\tlet title = '';\n\tlet extension = '';\n\n\tif ( src ) {\n\t\tconst decodedURI = safeDecodeURI( src );\n\t\tconst fileName = decodedURI.split( '/' ).pop();\n\t\tconst parts = fileName.split( '.' );\n\t\textension = parts.pop().toUpperCase();\n\t\ttitle = parts.join( '.' );\n\t}\n\n\tconst getSubtitleValue = () => {\n\t\tif ( isUploadInProgress ) {\n\t\t\treturn __( 'Uploadingâ€¦' );\n\t\t}\n\t\tif ( isUploadFailed ) {\n\t\t\treturn __( 'Failed to insert audio file. Please tap for options.' );\n\t\t}\n\t\treturn (\n\t\t\textension +\n\t\t\t// translators: displays audio file extension. e.g. MP3 audio file\n\t\t\t__( ' audio file' )\n\t\t);\n\t};\n\n\tfunction onAudioUploadCancelDialog() {\n\t\tif ( isUploadInProgress ) {\n\t\t\trequestImageUploadCancelDialog( id );\n\t\t} else if ( id && getProtocol( src ) === 'file:' ) {\n\t\t\trequestImageFailedRetryDialog( id );\n\t\t}\n\t}\n\n\treturn (\n\t\t<TouchableWithoutFeedback\n\t\t\taccessible={ ! isSelected }\n\t\t\tdisabled={ ! isSelected }\n\t\t\tonPress={ onAudioUploadCancelDialog }\n\t\t>\n\t\t\t<View style={ containerStyle }>\n\t\t\t\t<View style={ iconContainerStyle }>\n\t\t\t\t\t<Icon icon={ audio } style={ finalIconStyle } size={ 24 } />\n\t\t\t\t</View>\n\t\t\t\t<View style={ titleContainerStyle }>\n\t\t\t\t\t<Text style={ titleStyle }>{ title }</Text>\n\t\t\t\t\t<View style={ styles.subtitleContainer }>\n\t\t\t\t\t\t{ isUploadFailed && (\n\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\ticon={ warning }\n\t\t\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t\t\t...styles.errorIcon,\n\t\t\t\t\t\t\t\t\t...uploadFailedStyle,\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\tsize={ 16 }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<Text style={ finalSubtitleStyle }>\n\t\t\t\t\t\t\t{ getSubtitleValue() }\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</View>\n\t\t\t\t</View>\n\t\t\t\t{ ! isDisabled && (\n\t\t\t\t\t<TouchableWithoutFeedback\n\t\t\t\t\t\taccessibilityLabel={ __( 'Audio Player' ) }\n\t\t\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t\t\t\taccessibilityHint={ __(\n\t\t\t\t\t\t\t'Double tap to listen the audio file'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonPress={ onPressListen }\n\t\t\t\t\t>\n\t\t\t\t\t\t<View style={ buttonBackgroundStyle }>\n\t\t\t\t\t\t\t<Text style={ styles.buttonText }>\n\t\t\t\t\t\t\t\t{ __( 'OPEN' ) }\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</TouchableWithoutFeedback>\n\t\t\t\t) }\n\t\t\t\t{ isIOS && (\n\t\t\t\t\t<VideoPlayer\n\t\t\t\t\t\tsource={ { uri: src } }\n\t\t\t\t\t\tpaused={ paused }\n\t\t\t\t\t\tref={ ( ref ) => {\n\t\t\t\t\t\t\tthis.player = ref;\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tcontrols={ false }\n\t\t\t\t\t\tignoreSilentSwitch={ 'ignore' }\n\t\t\t\t\t\tonFullscreenPlayerWillPresent={ () => {\n\t\t\t\t\t\t\tsetPaused( false );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonFullscreenPlayerDidDismiss={ () => {\n\t\t\t\t\t\t\tsetPaused( true );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n}\n\nexport default withPreferredColorScheme( Player );\n"]}