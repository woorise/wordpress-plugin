{"version":3,"sources":["@wordpress/components/src/focal-point-picker/index.native.js"],"names":["Animated","PanResponder","View","Video","clamp","requestFocalPointPickerTooltipShown","setFocalPointPickerTooltipShown","__","Image","UnitControl","useRef","useState","useMemo","useEffect","usePreferredColorSchemeStyle","FocalPoint","Tooltip","styles","isVideoType","MIN_POSITION_VALUE","MAX_POSITION_VALUE","FOCAL_POINT_UNITS","default","label","value","FocalPointPicker","props","focalPoint","onChange","shouldEnableBottomSheetScroll","url","isVideo","containerSize","setContainerSize","sliderKey","setSliderKey","displayPlaceholder","setDisplayPlaceholder","videoNaturalSize","setVideoNaturalSize","tooltipVisible","setTooltipVisible","locationPageOffsetX","current","locationPageOffsetY","videoRef","tooltipShown","pan","ValueXY","setValue","x","width","y","height","panResponder","create","onStartShouldSetPanResponder","onStartShouldSetPanResponderCapture","onMoveShouldSetPanResponder","onMoveShouldSetPanResponderCapture","onPanResponderGrant","event","nativeEvent","locationX","locationY","pageX","pageY","extractOffset","onPanResponderMove","dx","dy","onPanResponderRelease","flattenOffset","toFixed","prevState","mediaBackground","mediaBackgroundDark","imagePreviewStyles","mediaPlaceholder","image","videoPreviewStyles","aspectRatio","opacity","video","focalPointGroupStyles","focalPointGroup","transform","translateX","interpolate","inputRange","outputRange","extrapolate","translateY","FOCAL_POINT_SIZE","focalPointStyles","marginLeft","marginTop","onTooltipPress","onMediaLayout","layout","onImageDataLoad","onVideoLoad","naturalSize","seek","onXCoordinateChange","onYCoordinateChange","container","media","panHandlers","mediaContainer","uri","Math","round"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { Animated, PanResponder, View } from 'react-native';\nimport Video from 'react-native-video';\nimport { clamp } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport {\n\trequestFocalPointPickerTooltipShown,\n\tsetFocalPointPickerTooltipShown,\n} from '@wordpress/react-native-bridge';\nimport { __ } from '@wordpress/i18n';\nimport { Image, UnitControl } from '@wordpress/components';\nimport { useRef, useState, useMemo, useEffect } from '@wordpress/element';\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport FocalPoint from './focal-point';\nimport Tooltip from './tooltip';\nimport styles from './style.scss';\nimport { isVideoType } from './utils';\n\nconst MIN_POSITION_VALUE = 0;\nconst MAX_POSITION_VALUE = 100;\nconst FOCAL_POINT_UNITS = [ { default: '50', label: '%', value: '%' } ];\n\nfunction FocalPointPicker( props ) {\n\tconst { focalPoint, onChange, shouldEnableBottomSheetScroll, url } = props;\n\n\tconst isVideo = isVideoType( url );\n\n\tconst [ containerSize, setContainerSize ] = useState( null );\n\tconst [ sliderKey, setSliderKey ] = useState( 0 );\n\tconst [ displayPlaceholder, setDisplayPlaceholder ] = useState( true );\n\tconst [ videoNaturalSize, setVideoNaturalSize ] = useState( null );\n\tconst [ tooltipVisible, setTooltipVisible ] = useState( false );\n\n\tlet locationPageOffsetX = useRef().current;\n\tlet locationPageOffsetY = useRef().current;\n\tconst videoRef = useRef( null );\n\n\tuseEffect( () => {\n\t\trequestFocalPointPickerTooltipShown( ( tooltipShown ) => {\n\t\t\tif ( ! tooltipShown ) {\n\t\t\t\tsetTooltipVisible( true );\n\t\t\t\tsetFocalPointPickerTooltipShown( true );\n\t\t\t}\n\t\t} );\n\t}, [] );\n\n\t// Animated coordinates for drag handle\n\tconst pan = useRef( new Animated.ValueXY() ).current;\n\n\t/**\n\t * Set drag handle position anytime focal point coordinates change.\n\t * E.g. initial render, dragging range sliders.\n\t */\n\tuseEffect( () => {\n\t\tif ( containerSize ) {\n\t\t\tpan.setValue( {\n\t\t\t\tx: focalPoint.x * containerSize.width,\n\t\t\t\ty: focalPoint.y * containerSize.height,\n\t\t\t} );\n\t\t}\n\t}, [ focalPoint, containerSize ] );\n\n\t// Pan responder to manage drag handle interactivity\n\tconst panResponder = useMemo(\n\t\t() =>\n\t\t\tPanResponder.create( {\n\t\t\t\tonStartShouldSetPanResponder: () => true,\n\t\t\t\tonStartShouldSetPanResponderCapture: () => true,\n\t\t\t\tonMoveShouldSetPanResponder: () => true,\n\t\t\t\tonMoveShouldSetPanResponderCapture: () => true,\n\n\t\t\t\tonPanResponderGrant: ( event ) => {\n\t\t\t\t\tshouldEnableBottomSheetScroll( false );\n\t\t\t\t\tconst {\n\t\t\t\t\t\tlocationX: x,\n\t\t\t\t\t\tlocationY: y,\n\t\t\t\t\t\tpageX,\n\t\t\t\t\t\tpageY,\n\t\t\t\t\t} = event.nativeEvent;\n\t\t\t\t\tlocationPageOffsetX = pageX - x;\n\t\t\t\t\tlocationPageOffsetY = pageY - y;\n\t\t\t\t\tpan.setValue( { x, y } ); // Set cursor to tap location\n\t\t\t\t\tpan.extractOffset(); // Set offset to current value\n\t\t\t\t},\n\t\t\t\t// Move cursor to match delta drag\n\t\t\t\tonPanResponderMove: Animated.event( [\n\t\t\t\t\tnull,\n\t\t\t\t\t{ dx: pan.x, dy: pan.y },\n\t\t\t\t] ),\n\t\t\t\tonPanResponderRelease: ( event ) => {\n\t\t\t\t\tshouldEnableBottomSheetScroll( true );\n\t\t\t\t\tpan.flattenOffset(); // Flatten offset into value\n\t\t\t\t\tconst { pageX, pageY } = event.nativeEvent;\n\t\t\t\t\t// Ideally, x and y below are merely locationX and locationY from the\n\t\t\t\t\t// nativeEvent. However, we are required to compute these relative\n\t\t\t\t\t// coordinates to workaround a bug affecting Android's PanResponder.\n\t\t\t\t\t// Specifically, dragging the handle outside the bounds of the image\n\t\t\t\t\t// results in inaccurate locationX and locationY coordinates to be\n\t\t\t\t\t// reported. https://git.io/JtWmi\n\t\t\t\t\tconst x = pageX - locationPageOffsetX;\n\t\t\t\t\tconst y = pageY - locationPageOffsetY;\n\t\t\t\t\tonChange( {\n\t\t\t\t\t\tx: clamp( x / containerSize?.width, 0, 1 ).toFixed( 2 ),\n\t\t\t\t\t\ty: clamp( y / containerSize?.height, 0, 1 ).toFixed(\n\t\t\t\t\t\t\t2\n\t\t\t\t\t\t),\n\t\t\t\t\t} );\n\t\t\t\t\t// Slider (child of RangeCell) is uncontrolled, so we must increment a\n\t\t\t\t\t// key to re-mount and sync the pan gesture values to the sliders\n\t\t\t\t\t// https://git.io/JTe4A\n\t\t\t\t\tsetSliderKey( ( prevState ) => prevState + 1 );\n\t\t\t\t},\n\t\t\t} ),\n\t\t[ containerSize ]\n\t);\n\n\tconst mediaBackground = usePreferredColorSchemeStyle(\n\t\tstyles.mediaBackground,\n\t\tstyles.mediaBackgroundDark\n\t);\n\tconst imagePreviewStyles = [\n\t\tdisplayPlaceholder && styles.mediaPlaceholder,\n\t\tstyles.image,\n\t];\n\tconst videoPreviewStyles = [\n\t\t{\n\t\t\taspectRatio:\n\t\t\t\tvideoNaturalSize &&\n\t\t\t\tvideoNaturalSize.width / videoNaturalSize.height,\n\t\t\t// Hide Video component since it has black background while loading the source\n\t\t\topacity: displayPlaceholder ? 0 : 1,\n\t\t},\n\t\tstyles.video,\n\t\tdisplayPlaceholder && styles.mediaPlaceholder,\n\t];\n\tconst focalPointGroupStyles = [\n\t\tstyles.focalPointGroup,\n\t\t{\n\t\t\ttransform: [\n\t\t\t\t{\n\t\t\t\t\ttranslateX: pan.x.interpolate( {\n\t\t\t\t\t\tinputRange: [ 0, containerSize?.width || 0 ],\n\t\t\t\t\t\toutputRange: [ 0, containerSize?.width || 0 ],\n\t\t\t\t\t\textrapolate: 'clamp',\n\t\t\t\t\t} ),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttranslateY: pan.y.interpolate( {\n\t\t\t\t\t\tinputRange: [ 0, containerSize?.height || 0 ],\n\t\t\t\t\t\toutputRange: [ 0, containerSize?.height || 0 ],\n\t\t\t\t\t\textrapolate: 'clamp',\n\t\t\t\t\t} ),\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t];\n\tconst FOCAL_POINT_SIZE = 50;\n\tconst focalPointStyles = [\n\t\tstyles.focalPoint,\n\t\t{\n\t\t\theight: FOCAL_POINT_SIZE,\n\t\t\tmarginLeft: -( FOCAL_POINT_SIZE / 2 ),\n\t\t\tmarginTop: -( FOCAL_POINT_SIZE / 2 ),\n\t\t\twidth: FOCAL_POINT_SIZE,\n\t\t},\n\t];\n\n\tconst onTooltipPress = () => setTooltipVisible( false );\n\tconst onMediaLayout = ( event ) => {\n\t\tconst { height, width } = event.nativeEvent.layout;\n\n\t\tif (\n\t\t\twidth !== 0 &&\n\t\t\theight !== 0 &&\n\t\t\t( containerSize?.width !== width ||\n\t\t\t\tcontainerSize?.height !== height )\n\t\t) {\n\t\t\tsetContainerSize( { width, height } );\n\t\t}\n\t};\n\tconst onImageDataLoad = () => setDisplayPlaceholder( false );\n\tconst onVideoLoad = ( event ) => {\n\t\tconst { height, width } = event.naturalSize;\n\t\tsetVideoNaturalSize( { height, width } );\n\t\tsetDisplayPlaceholder( false );\n\t\t// Avoid invisible, paused video on Android, presumably related to\n\t\t// https://git.io/Jt6Dr\n\t\tvideoRef?.current.seek( 0 );\n\t};\n\tconst onXCoordinateChange = ( x ) =>\n\t\tonChange( { x: ( x / 100 ).toFixed( 2 ) } );\n\tconst onYCoordinateChange = ( y ) =>\n\t\tonChange( { y: ( y / 100 ).toFixed( 2 ) } );\n\n\treturn (\n\t\t<View style={ styles.container }>\n\t\t\t<Tooltip onPress={ onTooltipPress } visible={ tooltipVisible }>\n\t\t\t\t<View style={ [ styles.media, mediaBackground ] }>\n\t\t\t\t\t<View\n\t\t\t\t\t\t{ ...panResponder.panHandlers }\n\t\t\t\t\t\tonLayout={ onMediaLayout }\n\t\t\t\t\t\tstyle={ styles.mediaContainer }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ ! isVideo && (\n\t\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\t\teditButton={ false }\n\t\t\t\t\t\t\t\thighlightSelected={ false }\n\t\t\t\t\t\t\t\tisSelected={ ! displayPlaceholder }\n\t\t\t\t\t\t\t\theight=\"100%\"\n\t\t\t\t\t\t\t\turl={ url }\n\t\t\t\t\t\t\t\tstyle={ imagePreviewStyles }\n\t\t\t\t\t\t\t\tonImageDataLoad={ onImageDataLoad }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ isVideo && (\n\t\t\t\t\t\t\t<Video\n\t\t\t\t\t\t\t\tmuted\n\t\t\t\t\t\t\t\tpaused\n\t\t\t\t\t\t\t\tdisableFocus\n\t\t\t\t\t\t\t\tonLoad={ onVideoLoad }\n\t\t\t\t\t\t\t\tref={ videoRef }\n\t\t\t\t\t\t\t\tresizeMode=\"contain\"\n\t\t\t\t\t\t\t\tsource={ { uri: url } }\n\t\t\t\t\t\t\t\tstyle={ videoPreviewStyles }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ ! displayPlaceholder && (\n\t\t\t\t\t\t\t<Animated.View\n\t\t\t\t\t\t\t\tpointerEvents=\"none\"\n\t\t\t\t\t\t\t\tstyle={ focalPointGroupStyles }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Tooltip.Label\n\t\t\t\t\t\t\t\t\ttext={ __( 'Drag to adjust focal point' ) }\n\t\t\t\t\t\t\t\t\tyOffset={ -( FOCAL_POINT_SIZE / 2 ) }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<FocalPoint\n\t\t\t\t\t\t\t\t\theight={ styles.focalPoint.height }\n\t\t\t\t\t\t\t\t\tstyle={ focalPointStyles }\n\t\t\t\t\t\t\t\t\twidth={ styles.focalPoint.width }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Animated.View>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</View>\n\t\t\t\t</View>\n\t\t\t\t<UnitControl\n\t\t\t\t\tkey={ `xAxis-${ sliderKey }` }\n\t\t\t\t\tlabel={ __( 'X-Axis Position' ) }\n\t\t\t\t\tmax={ MAX_POSITION_VALUE }\n\t\t\t\t\tmin={ MIN_POSITION_VALUE }\n\t\t\t\t\tonChange={ onXCoordinateChange }\n\t\t\t\t\tunit=\"%\"\n\t\t\t\t\tunits={ FOCAL_POINT_UNITS }\n\t\t\t\t\tvalue={ Math.round( focalPoint.x * 100 ) }\n\t\t\t\t/>\n\t\t\t\t<UnitControl\n\t\t\t\t\tkey={ `yAxis-${ sliderKey }` }\n\t\t\t\t\tlabel={ __( 'Y-Axis Position' ) }\n\t\t\t\t\tmax={ MAX_POSITION_VALUE }\n\t\t\t\t\tmin={ MIN_POSITION_VALUE }\n\t\t\t\t\tonChange={ onYCoordinateChange }\n\t\t\t\t\tunit=\"%\"\n\t\t\t\t\tunits={ FOCAL_POINT_UNITS }\n\t\t\t\t\tvalue={ Math.round( focalPoint.y * 100 ) }\n\t\t\t\t/>\n\t\t\t</Tooltip>\n\t\t</View>\n\t);\n}\n\nexport default FocalPointPicker;\n"]}