{"version":3,"sources":["@wordpress/components/src/custom-gradient-bar/control-points.js"],"names":["classnames","useInstanceId","useEffect","useRef","useState","__","sprintf","plus","Button","ColorPicker","Dropdown","KeyboardShortcuts","VisuallyHidden","addControlPoint","clampPercent","removeControlPoint","updateControlPointColor","updateControlPointColorByPosition","updateControlPointPosition","getHorizontalRelativeGradientPosition","COLOR_POPOVER_PROPS","GRADIENT_MARKERS_WIDTH","MINIMUM_SIGNIFICANT_MOVE","KEYBOARD_CONTROL_POINT_VARIATION","ControlPointKeyboardMove","position","value","onChange","children","shortcuts","right","event","stopPropagation","newPosition","left","ControlPointButton","isOpen","color","additionalProps","instanceId","descriptionId","ControlPoints","gradientPickerDomRef","ignoreMarkerPosition","controlPoints","onStartControlPointChange","onStopControlPointChange","controlPointMoveState","onMouseMove","relativePosition","clientX","current","initialPosition","index","significantMoveHappened","Math","abs","cleanEventListeners","window","removeEventListener","listenersActivated","map","point","onToggle","addEventListener","onClose","toRgbString","InsertPoint","onOpenInserter","onCloseInserter","insertPosition","alreadyInsertedPoint","setAlreadyInsertedPoint","undefined"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useInstanceId } from '@wordpress/compose';\nimport { useEffect, useRef, useState } from '@wordpress/element';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { plus } from '@wordpress/icons';\n\n/**\n * Internal dependencies\n */\nimport Button from '../button';\nimport ColorPicker from '../color-picker';\nimport Dropdown from '../dropdown';\nimport KeyboardShortcuts from '../keyboard-shortcuts';\nimport VisuallyHidden from '../visually-hidden';\n\nimport {\n\taddControlPoint,\n\tclampPercent,\n\tremoveControlPoint,\n\tupdateControlPointColor,\n\tupdateControlPointColorByPosition,\n\tupdateControlPointPosition,\n\tgetHorizontalRelativeGradientPosition,\n} from './utils';\nimport {\n\tCOLOR_POPOVER_PROPS,\n\tGRADIENT_MARKERS_WIDTH,\n\tMINIMUM_SIGNIFICANT_MOVE,\n\tKEYBOARD_CONTROL_POINT_VARIATION,\n} from './constants';\n\nfunction ControlPointKeyboardMove( { value: position, onChange, children } ) {\n\tconst shortcuts = {\n\t\tright( event ) {\n\t\t\t// Stop propagation of the key press event to avoid focus moving\n\t\t\t// to another editor area.\n\t\t\tevent.stopPropagation();\n\t\t\tconst newPosition = clampPercent(\n\t\t\t\tposition + KEYBOARD_CONTROL_POINT_VARIATION\n\t\t\t);\n\t\t\tonChange( newPosition );\n\t\t},\n\t\tleft( event ) {\n\t\t\t// Stop propagation of the key press event to avoid focus moving\n\t\t\t// to another editor area.\n\t\t\tevent.stopPropagation();\n\t\t\tconst newPosition = clampPercent(\n\t\t\t\tposition - KEYBOARD_CONTROL_POINT_VARIATION\n\t\t\t);\n\t\t\tonChange( newPosition );\n\t\t},\n\t};\n\n\treturn (\n\t\t<KeyboardShortcuts shortcuts={ shortcuts }>\n\t\t\t{ children }\n\t\t</KeyboardShortcuts>\n\t);\n}\n\nfunction ControlPointButton( {\n\tisOpen,\n\tposition,\n\tcolor,\n\tonChange,\n\t...additionalProps\n} ) {\n\tconst instanceId = useInstanceId( ControlPointButton );\n\tconst descriptionId = `components-custom-gradient-picker__control-point-button-description-${ instanceId }`;\n\treturn (\n\t\t<ControlPointKeyboardMove value={ position } onChange={ onChange }>\n\t\t\t<Button\n\t\t\t\taria-label={ sprintf(\n\t\t\t\t\t// translators: %1$s: gradient position e.g: 70, %2$s: gradient color code e.g: rgb(52,121,151).\n\t\t\t\t\t__(\n\t\t\t\t\t\t'Gradient control point at position %1$s%% with color code %2$s.'\n\t\t\t\t\t),\n\t\t\t\t\tposition,\n\t\t\t\t\tcolor\n\t\t\t\t) }\n\t\t\t\taria-describedby={ descriptionId }\n\t\t\t\taria-haspopup=\"true\"\n\t\t\t\taria-expanded={ isOpen }\n\t\t\t\tclassName={ classnames(\n\t\t\t\t\t'components-custom-gradient-picker__control-point-button',\n\t\t\t\t\t{\n\t\t\t\t\t\t'is-active': isOpen,\n\t\t\t\t\t}\n\t\t\t\t) }\n\t\t\t\tstyle={ {\n\t\t\t\t\tleft: `${ position }%`,\n\t\t\t\t} }\n\t\t\t\t{ ...additionalProps }\n\t\t\t/>\n\t\t\t<VisuallyHidden id={ descriptionId }>\n\t\t\t\t{ __(\n\t\t\t\t\t'Use your left or right arrow keys or drag and drop with the mouse to change the gradient position. Press the button to change the color or remove the control point.'\n\t\t\t\t) }\n\t\t\t</VisuallyHidden>\n\t\t</ControlPointKeyboardMove>\n\t);\n}\n\nfunction ControlPoints( {\n\tgradientPickerDomRef,\n\tignoreMarkerPosition,\n\tvalue: controlPoints,\n\tonChange,\n\tonStartControlPointChange,\n\tonStopControlPointChange,\n} ) {\n\tconst controlPointMoveState = useRef();\n\n\tconst onMouseMove = ( event ) => {\n\t\tconst relativePosition = getHorizontalRelativeGradientPosition(\n\t\t\tevent.clientX,\n\t\t\tgradientPickerDomRef.current,\n\t\t\tGRADIENT_MARKERS_WIDTH\n\t\t);\n\t\tconst {\n\t\t\tinitialPosition,\n\t\t\tindex,\n\t\t\tsignificantMoveHappened,\n\t\t} = controlPointMoveState.current;\n\t\tif (\n\t\t\t! significantMoveHappened &&\n\t\t\tMath.abs( initialPosition - relativePosition ) >=\n\t\t\t\tMINIMUM_SIGNIFICANT_MOVE\n\t\t) {\n\t\t\tcontrolPointMoveState.current.significantMoveHappened = true;\n\t\t}\n\n\t\tonChange(\n\t\t\tupdateControlPointPosition( controlPoints, index, relativePosition )\n\t\t);\n\t};\n\n\tconst cleanEventListeners = () => {\n\t\tif (\n\t\t\twindow &&\n\t\t\twindow.removeEventListener &&\n\t\t\tcontrolPointMoveState.current &&\n\t\t\tcontrolPointMoveState.current.listenersActivated\n\t\t) {\n\t\t\twindow.removeEventListener( 'mousemove', onMouseMove );\n\t\t\twindow.removeEventListener( 'mouseup', cleanEventListeners );\n\t\t\tonStopControlPointChange();\n\t\t\tcontrolPointMoveState.current.listenersActivated = false;\n\t\t}\n\t};\n\n\tuseEffect( () => {\n\t\treturn () => {\n\t\t\tcleanEventListeners();\n\t\t};\n\t}, [] );\n\n\treturn controlPoints.map( ( point, index ) => {\n\t\tconst initialPosition = point?.position;\n\t\treturn (\n\t\t\tignoreMarkerPosition !== initialPosition && (\n\t\t\t\t<Dropdown\n\t\t\t\t\tkey={ index }\n\t\t\t\t\tonClose={ onStopControlPointChange }\n\t\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\n\t\t\t\t\t\t<ControlPointButton\n\t\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tcontrolPointMoveState.current &&\n\t\t\t\t\t\t\t\t\tcontrolPointMoveState.current\n\t\t\t\t\t\t\t\t\t\t.significantMoveHappened\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ( isOpen ) {\n\t\t\t\t\t\t\t\t\tonStopControlPointChange();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tonStartControlPointChange();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tonToggle();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tonMouseDown={ () => {\n\t\t\t\t\t\t\t\tif ( window && window.addEventListener ) {\n\t\t\t\t\t\t\t\t\tcontrolPointMoveState.current = {\n\t\t\t\t\t\t\t\t\t\tinitialPosition,\n\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\tsignificantMoveHappened: false,\n\t\t\t\t\t\t\t\t\t\tlistenersActivated: true,\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\tonStartControlPointChange();\n\t\t\t\t\t\t\t\t\twindow.addEventListener(\n\t\t\t\t\t\t\t\t\t\t'mousemove',\n\t\t\t\t\t\t\t\t\t\tonMouseMove\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\twindow.addEventListener(\n\t\t\t\t\t\t\t\t\t\t'mouseup',\n\t\t\t\t\t\t\t\t\t\tcleanEventListeners\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\tisOpen={ isOpen }\n\t\t\t\t\t\t\tposition={ point.position }\n\t\t\t\t\t\t\tcolor={ point.color }\n\t\t\t\t\t\t\tonChange={ ( newPosition ) => {\n\t\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\t\tupdateControlPointPosition(\n\t\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\tnewPosition\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\trenderContent={ ( { onClose } ) => (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<ColorPicker\n\t\t\t\t\t\t\t\tcolor={ point.color }\n\t\t\t\t\t\t\t\tonChangeComplete={ ( { color } ) => {\n\t\t\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\t\t\tupdateControlPointColor(\n\t\t\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t\t\tcolor.toRgbString()\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tclassName=\"components-custom-gradient-picker__remove-control-point\"\n\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\t\t\tremoveControlPoint(\n\t\t\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\tisLink\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'Remove Control Point' ) }\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) }\n\t\t\t\t\tpopoverProps={ COLOR_POPOVER_PROPS }\n\t\t\t\t/>\n\t\t\t)\n\t\t);\n\t} );\n}\n\nfunction InsertPoint( {\n\tvalue: controlPoints,\n\tonChange,\n\tonOpenInserter,\n\tonCloseInserter,\n\tinsertPosition,\n} ) {\n\tconst [ alreadyInsertedPoint, setAlreadyInsertedPoint ] = useState( false );\n\treturn (\n\t\t<Dropdown\n\t\t\tclassName=\"components-custom-gradient-picker__inserter\"\n\t\t\tonClose={ () => {\n\t\t\t\tonCloseInserter();\n\t\t\t} }\n\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\n\t\t\t\t<Button\n\t\t\t\t\taria-expanded={ isOpen }\n\t\t\t\t\taria-haspopup=\"true\"\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tif ( isOpen ) {\n\t\t\t\t\t\t\tonCloseInserter();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetAlreadyInsertedPoint( false );\n\t\t\t\t\t\t\tonOpenInserter();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonToggle();\n\t\t\t\t\t} }\n\t\t\t\t\tclassName=\"components-custom-gradient-picker__insert-point\"\n\t\t\t\t\ticon={ plus }\n\t\t\t\t\tstyle={ {\n\t\t\t\t\t\tleft:\n\t\t\t\t\t\t\tinsertPosition !== null\n\t\t\t\t\t\t\t\t? `${ insertPosition }%`\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\trenderContent={ () => (\n\t\t\t\t<ColorPicker\n\t\t\t\t\tonChangeComplete={ ( { color } ) => {\n\t\t\t\t\t\tif ( ! alreadyInsertedPoint ) {\n\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\taddControlPoint(\n\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\tinsertPosition,\n\t\t\t\t\t\t\t\t\tcolor.toRgbString()\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tsetAlreadyInsertedPoint( true );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tonChange(\n\t\t\t\t\t\t\t\tupdateControlPointColorByPosition(\n\t\t\t\t\t\t\t\t\tcontrolPoints,\n\t\t\t\t\t\t\t\t\tinsertPosition,\n\t\t\t\t\t\t\t\t\tcolor.toRgbString()\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t) }\n\t\t\tpopoverProps={ COLOR_POPOVER_PROPS }\n\t\t/>\n\t);\n}\nControlPoints.InsertPoint = InsertPoint;\n\nexport default ControlPoints;\n"]}