{"version":3,"sources":["@wordpress/components/src/disabled/index.js"],"names":["includes","debounce","classnames","createContext","useCallback","useLayoutEffect","useRef","focus","StyledWrapper","Consumer","Provider","DISABLED_ELIGIBLE_NODE_NAMES","Disabled","className","children","isDisabled","props","node","disable","focusable","find","current","forEach","nodeName","setAttribute","tabIndex","getAttribute","removeAttribute","hasAttribute","debouncedDisable","leading","observer","window","MutationObserver","observe","childList","attributes","subtree","disconnect","cancel"],"mappings":";;;;AAAA;AACA;AACA;AACA,SAASA,QAAT,EAAmBC,QAAnB,QAAmC,QAAnC;AACA,OAAOC,UAAP,MAAuB,YAAvB;AAEA;AACA;AACA;;AACA,SACCC,aADD,EAECC,WAFD,EAGCC,eAHD,EAICC,MAJD,QAKO,oBALP;AAMA,SAASC,KAAT,QAAsB,gBAAtB;AAEA;AACA;AACA;;AACA,SAASC,aAAT,QAA8B,0BAA9B;;qBAE+BL,aAAa,CAAE,KAAF,C;IAApCM,Q,kBAAAA,Q;IAAUC,Q,kBAAAA,Q;AAElB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,IAAMC,4BAA4B,GAAG,CACpC,QADoC,EAEpC,UAFoC,EAGpC,OAHoC,EAIpC,UAJoC,EAKpC,QALoC,EAMpC,QANoC,EAOpC,UAPoC,CAArC;;AAUA,SAASC,QAAT,OAA0E;AAAA,MAArDC,SAAqD,QAArDA,SAAqD;AAAA,MAA1CC,QAA0C,QAA1CA,QAA0C;AAAA,6BAAhCC,UAAgC;AAAA,MAAhCA,UAAgC,gCAAnB,IAAmB;AAAA,MAAVC,KAAU;;AACzE,MAAMC,IAAI,GAAGX,MAAM,EAAnB;;AAEA,MAAMY,OAAO,GAAG,SAAVA,OAAU,GAAM;AACrBX,IAAAA,KAAK,CAACY,SAAN,CAAgBC,IAAhB,CAAsBH,IAAI,CAACI,OAA3B,EAAqCC,OAArC,CAA8C,UAAEH,SAAF,EAAiB;AAC9D,UACCnB,QAAQ,CAAEW,4BAAF,EAAgCQ,SAAS,CAACI,QAA1C,CADT,EAEE;AACDJ,QAAAA,SAAS,CAACK,YAAV,CAAwB,UAAxB,EAAoC,EAApC;AACA;;AAED,UAAKL,SAAS,CAACI,QAAV,KAAuB,GAA5B,EAAkC;AACjCJ,QAAAA,SAAS,CAACK,YAAV,CAAwB,UAAxB,EAAoC,CAAC,CAArC;AACA;;AAED,UAAMC,QAAQ,GAAGN,SAAS,CAACO,YAAV,CAAwB,UAAxB,CAAjB;;AACA,UAAKD,QAAQ,KAAK,IAAb,IAAqBA,QAAQ,KAAK,IAAvC,EAA8C;AAC7CN,QAAAA,SAAS,CAACQ,eAAV,CAA2B,UAA3B;AACA;;AAED,UAAKR,SAAS,CAACS,YAAV,CAAwB,iBAAxB,CAAL,EAAmD;AAClDT,QAAAA,SAAS,CAACK,YAAV,CAAwB,iBAAxB,EAA2C,OAA3C;AACA;AACD,KAnBD;AAoBA,GArBD,CAHyE,CA0BzE;AACA;;;AACA,MAAMK,gBAAgB,GAAGzB,WAAW,CACnCH,QAAQ,CAAEiB,OAAF,EAAW;AAAEY,IAAAA,OAAO,EAAE;AAAX,GAAX,CAD2B,EAEnC,EAFmC,CAApC;AAKAzB,EAAAA,eAAe,CAAE,YAAM;AACtB,QAAK,CAAEU,UAAP,EAAoB;AACnB;AACA;;AAEDG,IAAAA,OAAO;AAEP,QAAMa,QAAQ,GAAG,IAAIC,MAAM,CAACC,gBAAX,CAA6BJ,gBAA7B,CAAjB;AACAE,IAAAA,QAAQ,CAACG,OAAT,CAAkBjB,IAAI,CAACI,OAAvB,EAAgC;AAC/Bc,MAAAA,SAAS,EAAE,IADoB;AAE/BC,MAAAA,UAAU,EAAE,IAFmB;AAG/BC,MAAAA,OAAO,EAAE;AAHsB,KAAhC;AAMA,WAAO,YAAM;AACZN,MAAAA,QAAQ,CAACO,UAAT;AACAT,MAAAA,gBAAgB,CAACU,MAAjB;AACA,KAHD;AAIA,GAlBc,EAkBZ,EAlBY,CAAf;;AAoBA,MAAK,CAAExB,UAAP,EAAoB;AACnB,WAAO,cAAC,QAAD;AAAU,MAAA,KAAK,EAAG;AAAlB,OAA4BD,QAA5B,CAAP;AACA;;AAED,SACC,cAAC,QAAD;AAAU,IAAA,KAAK,EAAG;AAAlB,KACC,cAAC,aAAD;AACC,IAAA,GAAG,EAAGG,IADP;AAEC,IAAA,SAAS,EAAGf,UAAU,CAAEW,SAAF,EAAa,qBAAb;AAFvB,KAGMG,KAHN,GAKGF,QALH,CADD,CADD;AAWA;;AAEDF,QAAQ,CAACH,QAAT,GAAoBA,QAApB;AAEA,eAAeG,QAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { includes, debounce } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tcreateContext,\n\tuseCallback,\n\tuseLayoutEffect,\n\tuseRef,\n} from '@wordpress/element';\nimport { focus } from '@wordpress/dom';\n\n/**\n * Internal dependencies\n */\nimport { StyledWrapper } from './styles/disabled-styles';\n\nconst { Consumer, Provider } = createContext( false );\n\n/**\n * Names of control nodes which qualify for disabled behavior.\n *\n * See WHATWG HTML Standard: 4.10.18.5: \"Enabling and disabling form controls: the disabled attribute\".\n *\n * @see https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#enabling-and-disabling-form-controls:-the-disabled-attribute\n *\n * @type {string[]}\n */\nconst DISABLED_ELIGIBLE_NODE_NAMES = [\n\t'BUTTON',\n\t'FIELDSET',\n\t'INPUT',\n\t'OPTGROUP',\n\t'OPTION',\n\t'SELECT',\n\t'TEXTAREA',\n];\n\nfunction Disabled( { className, children, isDisabled = true, ...props } ) {\n\tconst node = useRef();\n\n\tconst disable = () => {\n\t\tfocus.focusable.find( node.current ).forEach( ( focusable ) => {\n\t\t\tif (\n\t\t\t\tincludes( DISABLED_ELIGIBLE_NODE_NAMES, focusable.nodeName )\n\t\t\t) {\n\t\t\t\tfocusable.setAttribute( 'disabled', '' );\n\t\t\t}\n\n\t\t\tif ( focusable.nodeName === 'A' ) {\n\t\t\t\tfocusable.setAttribute( 'tabindex', -1 );\n\t\t\t}\n\n\t\t\tconst tabIndex = focusable.getAttribute( 'tabindex' );\n\t\t\tif ( tabIndex !== null && tabIndex !== '-1' ) {\n\t\t\t\tfocusable.removeAttribute( 'tabindex' );\n\t\t\t}\n\n\t\t\tif ( focusable.hasAttribute( 'contenteditable' ) ) {\n\t\t\t\tfocusable.setAttribute( 'contenteditable', 'false' );\n\t\t\t}\n\t\t} );\n\t};\n\n\t// Debounce re-disable since disabling process itself will incur\n\t// additional mutations which should be ignored.\n\tconst debouncedDisable = useCallback(\n\t\tdebounce( disable, { leading: true } ),\n\t\t[]\n\t);\n\n\tuseLayoutEffect( () => {\n\t\tif ( ! isDisabled ) {\n\t\t\treturn;\n\t\t}\n\n\t\tdisable();\n\n\t\tconst observer = new window.MutationObserver( debouncedDisable );\n\t\tobserver.observe( node.current, {\n\t\t\tchildList: true,\n\t\t\tattributes: true,\n\t\t\tsubtree: true,\n\t\t} );\n\n\t\treturn () => {\n\t\t\tobserver.disconnect();\n\t\t\tdebouncedDisable.cancel();\n\t\t};\n\t}, [] );\n\n\tif ( ! isDisabled ) {\n\t\treturn <Provider value={ false }>{ children }</Provider>;\n\t}\n\n\treturn (\n\t\t<Provider value={ true }>\n\t\t\t<StyledWrapper\n\t\t\t\tref={ node }\n\t\t\t\tclassName={ classnames( className, 'components-disabled' ) }\n\t\t\t\t{ ...props }\n\t\t\t>\n\t\t\t\t{ children }\n\t\t\t</StyledWrapper>\n\t\t</Provider>\n\t);\n}\n\nDisabled.Consumer = Consumer;\n\nexport default Disabled;\n"]}