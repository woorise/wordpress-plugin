"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useModalState = exports.useModalContext = exports.ModalContext = void 0;

var _data = require("@wordpress/data");

var _react = require("react");

var _store = _interopRequireDefault(require("./store"));

var ModalContext = /*#__PURE__*/(0, _react.createContext)({
  dialog: {}
});
exports.ModalContext = ModalContext;

var useModalContext = function () {
  return (0, _react.useContext)(ModalContext);
};
/**
 * @param {{ baseId: string, visible: boolean }} dialog
 * @return {{ isUnderLayer: boolean }}
 */


exports.useModalContext = useModalContext;

var useModalState = function (dialog) {
  var _useDispatch = (0, _data.useDispatch)(_store.default),
      mount = _useDispatch.mount,
      unmount = _useDispatch.unmount;

  var baseId = dialog.baseId,
      visible = dialog.visible;
  (0, _react.useEffect)(function () {
    if (visible) {
      mount(baseId);
    } else {
      unmount(baseId);
    }

    return function () {
      unmount(baseId);
    };
  }, [baseId, visible, mount, unmount]);
  var isUnderLayer = (0, _data.useSelect)(function (select) {
    return select(_store.default).getIsUnderLayer(baseId);
  });
  return {
    isUnderLayer: isUnderLayer
  };
};

exports.useModalState = useModalState;