"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _taggedTemplateLiteralLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteralLoose"));

var _react = require("@testing-library/react");

var _context = require("@wp-g2/context");

var _react2 = _interopRequireDefault(require("react"));

var _css = require("../css");

var _space = require("../mixins/space");

var _system = require("../system");

function _templateObject8() {
  var data = (0, _taggedTemplateLiteralLoose2.default)(["\n\t\t\tcolor: red;\n\t\t\t", " {\n\t\t\t\tcolor: blue;\n\t\t\t}\n\t\t"]);

  _templateObject8 = function () {
    return data;
  };

  return data;
}

function _templateObject7() {
  var data = (0, _taggedTemplateLiteralLoose2.default)(["\n\t\t\tcolor: red;\n\t\t\t", " {\n\t\t\t\tcolor: blue;\n\t\t\t}\n\t\t"]);

  _templateObject7 = function () {
    return data;
  };

  return data;
}

function _templateObject6() {
  var data = (0, _taggedTemplateLiteralLoose2.default)(["\n\t\t\t", " {\n\t\t\t\tcolor: blue;\n\t\t\t}\n\t\t"]);

  _templateObject6 = function () {
    return data;
  };

  return data;
}

function _templateObject5() {
  var data = (0, _taggedTemplateLiteralLoose2.default)([""]);

  _templateObject5 = function () {
    return data;
  };

  return data;
}

function _templateObject4() {
  var data = (0, _taggedTemplateLiteralLoose2.default)(["\n\t\t\tcolor: red;\n\t\t\t", " {\n\t\t\t\tcolor: blue;\n\t\t\t}\n\t\t"]);

  _templateObject4 = function () {
    return data;
  };

  return data;
}

function _templateObject3() {
  var data = (0, _taggedTemplateLiteralLoose2.default)([""]);

  _templateObject3 = function () {
    return data;
  };

  return data;
}

function _templateObject2() {
  var data = (0, _taggedTemplateLiteralLoose2.default)(["\n\t\t\tcolor: red;\n\t\t\t", " {\n\t\t\t\tcolor: blue;\n\t\t\t}\n\t\t"]);

  _templateObject2 = function () {
    return data;
  };

  return data;
}

function _templateObject() {
  var data = (0, _taggedTemplateLiteralLoose2.default)(["\n\t\t\tbackground-color: blue;\n\t\t"]);

  _templateObject = function () {
    return data;
  };

  return data;
}

describe('css', function () {
  var getLastAppliedCssRule = function () {
    var styles = document.getElementsByTagName('style');
    var lastSheet = Array.from(styles).slice(-1)[0];
    var rules = Array.from(lastSheet.sheet.cssRules);
    return rules.slice(-1)[0];
  };

  beforeEach(function () {
    // clean up generated styles and elements
    document.head.innerHTML = '';
  });
  it('should interpolate styled components from core components', function () {
    var StyledA = _system.styled.div(_templateObject());

    var classes = (0, _css.css)(_templateObject2(), StyledA);
    var rule = getLastAppliedCssRule();

    var _render = (0, _react.render)( /*#__PURE__*/_react2.default.createElement("div", {
      className: classes
    }, /*#__PURE__*/_react2.default.createElement(StyledA, null))),
        container = _render.container;

    var styledA = container.firstChild.firstChild;
    expect(styledA.matches(rule.selectorText)).toBe(true);
  });
  it('should interpolate styled components', function () {
    var StyledComponent = (0, _system.styled)(function Component(_ref) {
      var className = _ref.className;
      return /*#__PURE__*/_react2.default.createElement("div", {
        className: className
      });
    })(_templateObject3());
    var classes = (0, _css.css)(_templateObject4(), StyledComponent);
    var rule = getLastAppliedCssRule();

    var _render2 = (0, _react.render)( /*#__PURE__*/_react2.default.createElement("div", {
      className: classes
    }, /*#__PURE__*/_react2.default.createElement(StyledComponent, null))),
        container = _render2.container;

    var styledComponent = container.firstChild.firstChild;
    expect(styledComponent.matches(rule.selectorText)).toBe(true);
  });
  it('should interpolate styled components inside of styled component styles', function () {
    var StyledA = _system.styled.div(_templateObject5());

    var StyledB = _system.styled.div(_templateObject6(), StyledA);

    var _render3 = (0, _react.render)( /*#__PURE__*/_react2.default.createElement(StyledB, null, /*#__PURE__*/_react2.default.createElement(StyledA, null))),
        container = _render3.container;

    var rule = getLastAppliedCssRule();
    var styledA = container.firstChild.firstChild;
    expect(styledA.matches(rule.selectorText)).toBe(true);
  });
  it('should interpolate context-connected components', function () {
    var Connected = (0, _context.contextConnect)(function TestConnectedStyledComponent(props, forwardedRef) {
      var connectedProps = (0, _context.useContextSystem)(props, 'TestConnectedStyledComponent');
      return /*#__PURE__*/_react2.default.createElement("div", Object.assign({}, connectedProps, {
        ref: forwardedRef
      }));
    }, 'TestConnectedStyledComponent');
    var classes = (0, _css.css)(_templateObject7(), Connected);
    var rule = getLastAppliedCssRule();

    var _render4 = (0, _react.render)( /*#__PURE__*/_react2.default.createElement("div", {
      className: classes
    }, /*#__PURE__*/_react2.default.createElement(Connected, null))),
        container = _render4.container;

    var connected = container.firstChild.firstChild;
    expect(connected.matches(rule.selectorText)).toBe(true);
  });
  it('should interpolate context-connected-components in styled', function () {
    var Connected = (0, _context.contextConnect)(function TestConnectedStyledComponent(props, forwardedRef) {
      var connectedProps = (0, _context.useContextSystem)(props, 'TestConnectedStyledComponent');
      return /*#__PURE__*/_react2.default.createElement("div", Object.assign({}, connectedProps, {
        ref: forwardedRef
      }));
    }, 'TestConnectedStyledComponent');

    var Container = _system.styled.div(_templateObject8(), Connected);

    var _render5 = (0, _react.render)( /*#__PURE__*/_react2.default.createElement(Container, null, /*#__PURE__*/_react2.default.createElement(Connected, null))),
        container = _render5.container;

    var rule = getLastAppliedCssRule();
    var connected = container.firstChild.firstChild;
    expect(connected.matches(rule.selectorText)).toBe(true);
  });
});
describe('scales', function () {
  test('should transform space values', function () {
    var numberValues = {
      gridGap: 4,
      gridColumnGap: 4,
      gridRowGap: 4,
      gap: 4,
      columnGap: 4,
      rowGap: 4
    };

    for (var key in numberValues) {
      var value = numberValues[key];
      var assert = {};
      var result = {};
      assert[key] = value;
      result[key] = (0, _space.space)(value);
      expect((0, _css.getScaleStyles)(assert)).toEqual(result);
    }

    var stringValues = {
      gridGap: '6px',
      gridColumnGap: '6px',
      gridRowGap: '6px',
      gap: '6px',
      columnGap: '6px',
      rowGap: '6px'
    };

    for (var _key in stringValues) {
      var _value = stringValues[_key];
      var _assert = {};
      var _result = {};
      _assert[_key] = _value;
      _result[_key] = (0, _space.space)(_value);
      expect((0, _css.getScaleStyles)(_assert)).toEqual(_result);
    }
  });
});